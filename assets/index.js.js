import{s as e,l as t,t as r,S as s}from"./constants.js";import{u as a,r as n,j as o,R as l,a as i,c as d}from"./useStorage.js";import{a as c,u,s as m}from"./supabaseService.js";function b({onClose:r}){var s,l,i,d,u,m,b,h;const[x,f,g]=a("profile",{}),p=null==x?void 0:x.profile,v=(null==x?void 0:x.skills)||[],y=g,[w,j]=n.useState(!1),[N,k]=n.useState(!1);n.useEffect(()=>{p||(async()=>{var r;try{const t=await e.get("auth"),s=null==(r=null==t?void 0:t.profile)?void 0:r.freelancer_auth_token;if(s){const e=await c.fetchUserProfile(s);e.success&&e.data&&await f({profile:e.data,skills:e.data.jobs||[],cacheTime:Date.now()})}}catch(s){t.error(`Error fetching profile: ${s.message}`)}})()},[p,f]);const C=(null==p?void 0:p.username)||"Unknown",S=(null==p?void 0:p.public_name)||(null==p?void 0:p.display_name)||(null==p?void 0:p.name)||"",I=(null==p?void 0:p.id)||"-",E=(null==(s=null==p?void 0:p.membership_details)?void 0:s.name)||(null==p?void 0:p.membership)||"Free",D=(null==(i=null==(l=null==p?void 0:p.location)?void 0:l.country)?void 0:i.name)||(null==(d=null==p?void 0:p.country_details)?void 0:d.name)||"N/A",P=(null==p?void 0:p.tagline)||(null==p?void 0:p.title)||"",R=(null==p?void 0:p.profile_description)||(null==p?void 0:p.description)||"No profile summary available.",T=(null==(m=null==(u=null==p?void 0:p.reputation)?void 0:u.entire_history)?void 0:m.reviews)||(null==p?void 0:p.reviews)||0,F=(null==(h=null==(b=null==p?void 0:p.reputation)?void 0:b.entire_history)?void 0:h.overall)||(null==p?void 0:p.rating)||"-",M=(null==v?void 0:v.length)||0,A=(null==p?void 0:p.avatar_cdn)||(null==p?void 0:p.avatar)||(null==p?void 0:p.profile_picture)||null;return o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black bg-opacity-50",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:o.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg shadow-xl w-[600px] max-h-[80vh] flex flex-col overflow-hidden",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-2.5 border-b border-dark-border cursor-move bg-dark-bg",children:[o.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[o.jsx("i",{className:"fas fa-user text-blue-400"}),"Profile"]}),o.jsx("button",{onClick:r,className:"text-white hover:text-gray-300 transition-colors",children:o.jsx("i",{className:"fas fa-times text-xl"})})]}),o.jsxs("div",{className:"p-4 overflow-y-auto flex-1 bg-dark-card [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]",children:[null,o.jsxs("div",{className:"flex items-center gap-3 p-3 bg-dark-bg border border-dark-border rounded-lg mb-3",children:[o.jsxs("div",{className:"w-12 h-12 bg-dark-card border border-dark-border rounded-full flex items-center justify-center overflow-hidden relative",children:[A?o.jsx("img",{src:A,alt:C,className:"w-full h-full object-cover",onError:e=>{e.target.style.display="none";const t=e.target.parentElement.querySelector(".avatar-fallback");t&&(t.style.display="flex")}}):null,o.jsx("div",{className:"avatar-fallback w-full h-full bg-dark-card border border-dark-border rounded-full flex items-center justify-center text-white "+(A?"hidden":"flex"),children:o.jsx("i",{className:"fas fa-user text-lg"})})]}),o.jsxs("div",{className:"flex-1 text-white",children:[o.jsxs("p",{className:"font-semibold text-white",children:["@",C]}),o.jsx("p",{className:"text-xs text-gray-400",children:S||"Loading..."})]}),o.jsx("button",{onClick:async()=>{var r;const s=await e.get("auth"),a=null==(r=null==s?void 0:s.profile)?void 0:r.freelancer_auth_token;if(a){const e=await c.fetchUserProfile(a);e.success&&e.data&&(await f({profile:e.data,skills:e.data.jobs||[],cacheTime:Date.now()}),t.success("Profile refreshed successfully",!0))}},disabled:y||!1,className:"w-8 h-8 bg-dark-card border border-dark-border text-white rounded-full hover:bg-dark-border hover:text-white disabled:opacity-50 transition-colors flex items-center justify-center",title:"Refresh Profile",children:o.jsx("i",{className:"fas fa-rotate text-sm"})})]}),y&&!p?o.jsx("div",{className:"text-center py-8 text-white",children:"Loading profile..."}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[o.jsxs("div",{className:"bg-dark-bg border border-dark-border p-2 rounded text-center",children:[o.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"User ID"}),o.jsx("div",{className:"text-sm font-bold text-white",children:I})]}),o.jsxs("div",{className:"bg-dark-bg border border-dark-border p-2 rounded text-center",children:[o.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Membership"}),o.jsx("div",{className:"text-sm font-bold text-white",children:E})]}),o.jsxs("div",{className:"bg-dark-bg border border-dark-border p-2 rounded text-center",children:[o.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Country"}),o.jsx("div",{className:"text-sm font-bold text-white",children:D})]})]}),o.jsxs("div",{className:"mb-3",children:[o.jsx("div",{className:"text-base font-bold text-white mb-3",children:"Overview"}),o.jsxs("div",{className:"text-sm font-semibold text-white mb-2 pb-2 border-b-2 border-dark-border flex items-center justify-between cursor-pointer hover:text-gray-300 transition-colors",onClick:()=>j(!w),children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("i",{className:"fas fa-file-alt"}),"Profile Summary"]}),o.jsx("i",{className:`fas fa-chevron-${w?"up":"down"} text-xs`})]}),w&&o.jsxs(o.Fragment,{children:[P&&o.jsx("div",{className:"text-sm font-bold text-white whitespace-pre-wrap mb-3",children:P}),o.jsx("div",{className:"text-sm text-white whitespace-pre-wrap",children:R})]})]}),o.jsxs("div",{className:"mb-3",children:[o.jsxs("div",{className:"text-sm font-semibold text-white mb-2 pb-2 border-b-2 border-dark-border flex items-center justify-between cursor-pointer hover:text-gray-300 transition-colors",onClick:()=>k(!N),children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("i",{className:"fas fa-code"}),"Your Skills (",M,")"]}),o.jsx("i",{className:`fas fa-chevron-${N?"up":"down"} text-xs`})]}),N&&o.jsx("div",{className:"flex flex-wrap gap-2",children:v&&v.length>0?v.map((e,t)=>o.jsx("span",{className:"px-3 py-1 bg-blue-600 text-white text-xs rounded-full",children:"string"==typeof e?e:e.name||e},t)):o.jsx("div",{className:"text-gray-400 text-sm",children:"No skills listed"})})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"text-sm font-semibold text-white mb-2 pb-2 border-b-2 border-dark-border flex items-center gap-2",children:[o.jsx("i",{className:"fas fa-chart-bar"}),"Statistics"]}),o.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[o.jsxs("div",{className:"bg-dark-bg border border-dark-border p-3 rounded text-center",children:[o.jsx("div",{className:"text-xl font-bold text-blue-400 mb-1",children:T}),o.jsx("div",{className:"text-xs text-gray-400",children:"Reviews"})]}),o.jsxs("div",{className:"bg-dark-bg border border-dark-border p-3 rounded text-center",children:[o.jsx("div",{className:"text-xl font-bold text-blue-400 mb-1",children:F}),o.jsx("div",{className:"text-xs text-gray-400",children:"Rating"})]}),o.jsxs("div",{className:"bg-dark-bg border border-dark-border p-3 rounded text-center",children:[o.jsx("div",{className:"text-xl font-bold text-blue-400 mb-1",children:M}),o.jsx("div",{className:"text-xs text-gray-400",children:"Skills"})]})]})]})]})]})]})})}const h=[{color:"#a1c4c3",title:"This is a new employer. Proceed with caution."},{color:"green",title:"Amazing employer. Very high chance of awarding the project. Make sure to write a convincing bid - it will pay off."},{color:"blue",title:"Great employer. Very likely will award someone. Write a good bid."},{color:"#c7c70a",title:"Medium chance of awarding."},{color:"purple",title:"Low chance of employer awarding the project. Only bid if project is very interesting."},{color:"red",title:"Employer has poor track record of awarding projects. Best look for another project to bid on."}];function x({onClose:r}){var s,l,i,d,m,b,x,f;const[g]=a("project",{}),[p]=a("filters",{}),[v]=a("auth",{}),[y]=a("profile",{}),[w]=a("chat",{threads:[]}),j=null==g?void 0:g.currentProject,N=null==g?void 0:g.employerDetails,k=(null==g?void 0:g.hasBid)||!1,C=null==g?void 0:g.bidInfo,{hideClients:S,hideCountries:I,hideCurrencies:E}=p,D=null==v?void 0:v.profile,P=null==y?void 0:y.profile,R=(null==w?void 0:w.threads)||[],[T,F]=n.useState(!1),[M,A]=n.useState(!1),[B,L]=n.useState(!1),[$,U]=n.useState(null),[_,O]=n.useState(!1),[z,G]=n.useState(!1),[H,W]=n.useState(!1),[Y,K]=n.useState(null),[X,V]=n.useState(null),[q,J]=n.useState(!1),Q=X?R.find(e=>e.threadId===X):null,Z=(e,t)=>{let r;if("client"===e)r=S;else if("country"===e)r=I;else{if("currency"!==e)return!1;r=E}const s=r?u.parseCommaSeparated(r).map(e=>e.trim()):[];if("currency"===e){const e=t.trim().toUpperCase();return s.some(t=>t.toUpperCase()===e)}{const e=t.trim().toLowerCase();return s.some(t=>t.toLowerCase()===e)}},ee=(e,t)=>{var r,s,a,n,o,l,i,d,c,u;return(null==(s=null==(r=null==t?void 0:t.location)?void 0:r.country)?void 0:s.name)?t.location.country.name:(null==(a=null==t?void 0:t.country_details)?void 0:a.name)?t.country_details.name:(null==t?void 0:t.country)?t.country:(null==(l=null==(o=null==(n=null==e?void 0:e.owner)?void 0:n.location)?void 0:o.country)?void 0:l.name)?e.owner.location.country.name:(null==(i=null==e?void 0:e.owner)?void 0:i.country)?e.owner.country:(null==(c=null==(d=null==e?void 0:e.location)?void 0:d.country)?void 0:c.name)?e.location.country.name:(null==(u=null==e?void 0:e.country_details)?void 0:u.name)?e.country_details.name:(null==e?void 0:e.country)?e.country:"Unknown"};n.useEffect(()=>{(j||N)&&(()=>{var e,t;if((null==N?void 0:N.name)||(null==j?void 0:j.owner_id)){const t=(null==N?void 0:N.name)||(null==(e=null==j?void 0:j.owner_id)?void 0:e.toString())||"";if(t){const e=Z("client",t);F(e)}}const r=ee(j,N);if(r&&"Unknown"!==r){const e=Z("country",r);A(e)}const s=(null==(t=null==j?void 0:j.currency)?void 0:t.code)||(null==j?void 0:j.currency_code);if(s){const e=Z("currency",s);L(e)}})()},[j,N,S,I,E]),n.useEffect(()=>{(async()=>{if(j&&(null==D?void 0:D.freelancer_user_id)&&(null==D?void 0:D.freelancer_auth_token)&&!k&&j.id)try{const t=await c.checkSelfBid(j.id,D.freelancer_user_id,D.freelancer_auth_token);if(t.success){const r=await e.get("project")||{};await e.set("project",{...r,hasBid:t.hasBid,bidInfo:t})}}catch(t){}})()},[null==j?void 0:j.id,null==D?void 0:D.freelancer_user_id,null==D?void 0:D.freelancer_auth_token,k]),n.useEffect(()=>{(async()=>{var e;if(!k||!j)return void V(null);const r=null==D?void 0:D.freelancer_auth_token,s=null==D?void 0:D.freelancer_user_id;if(!s)return void t.error("Freelancer user ID not found");if(!r)return void t.error("Freelancer authentication token not found");if(!r.includes(";"))return void t.error("Invalid auth token format: missing semicolon");const a=j.owner_id||(null==(e=j.owner)?void 0:e.id);if(a){J(!0);try{const e=await c.createMessageThread([parseInt(a),parseInt(s.toString())],"project",j.id,r);if(e.success&&e.threadId)V(e.threadId);else{const r=e.message||e.error||"Failed to get thread ID";t.error(`Failed to get thread ID: ${r}`),V(null)}}catch(n){const e=n.message||"Failed to fetch thread";t.error(`Error fetching thread: ${e}`),V(null)}finally{J(!1)}}else t.error("Project owner ID not available")})()},[k,j,D]);const te=async e=>{if(e&&"N/A"!==e)try{await navigator.clipboard.writeText(e),t.success(`Copied to clipboard: ${e}`)}catch(r){t.error(`Failed to copy: ${r.message}`)}},re=!!window.location.pathname.match(/\/projects\/(.+?)(?:\/details)?(?:\?|$)/),se=(null==v?void 0:v.user)||null,ae=(null==v?void 0:v.session)||null,ne=(null==v?void 0:v.isAuthenticated)||!(!se||!ae);if(t.log(`[ProjectModal] Render check: isAuthenticated=${ne}, onProjectPage=${re}, hasProject=${!!j}`),!ne)return t.warn("[ProjectModal] Not rendering modal - user not authenticated"),null;if(!re)return o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black bg-opacity-50",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:o.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg shadow-xl w-[600px] max-h-[80vh] flex flex-col overflow-hidden",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-2.5 border-b border-dark-border cursor-move bg-dark-bg",children:[o.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[o.jsx("i",{className:"fas fa-folder text-purple-400"}),"Project Information"]}),o.jsx("button",{onClick:r,className:"text-white hover:text-gray-300 transition-colors",children:o.jsx("i",{className:"fas fa-times text-xl"})})]}),o.jsx("div",{className:"p-4 overflow-y-auto bg-dark-card [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]",children:o.jsxs("div",{className:"text-center py-8",children:[o.jsx("div",{className:"text-gray-400 mb-2",children:o.jsx("i",{className:"fas fa-exclamation-circle text-yellow-500 mb-3 text-2xl"})}),o.jsx("div",{className:"text-white font-semibold mb-2",children:"Not on a project page"}),o.jsx("div",{className:"text-sm text-gray-400",children:"Please navigate to a project page on Freelancer.com to view project information."})]})})]})});if(!j)return o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black bg-opacity-50",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:o.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg shadow-xl w-[600px] max-h-[80vh] flex flex-col overflow-hidden",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-2.5 border-b border-dark-border cursor-move bg-dark-bg",children:[o.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[o.jsx("i",{className:"fas fa-folder text-purple-400"}),"Project Information"]}),o.jsx("button",{onClick:r,className:"text-white hover:text-gray-300 transition-colors",children:o.jsx("i",{className:"fas fa-times text-xl"})})]}),o.jsx("div",{className:"p-4 overflow-y-auto bg-dark-card [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]",children:o.jsxs("div",{className:"text-center py-8",children:[o.jsx("div",{className:"text-gray-400 mb-2",children:o.jsx("i",{className:"fas fa-info-circle text-blue-500 mb-3 text-2xl"})}),o.jsx("div",{className:"text-white font-semibold mb-2",children:"Project data not available"}),o.jsx("div",{className:"text-sm text-gray-400",children:"The project information is being loaded. Please wait a moment or refresh the page."})]})})]})});const oe=j.seo_url||(()=>{const e=window.location.pathname.match(/\/projects\/(.+?)(?:\/details)?(?:\?|$)/);return e?e[1].replace(/\/$/,""):"N/A"})(),le=((null==(s=j.currency)?void 0:s.code)||j.currency_code||"USD").toUpperCase(),ie=u.getCurrencySymbol(le),de=ee(j,N),ce=(ue=j,(null==(he=null==(be=null==(me=N)?void 0:me.location)?void 0:be.country)?void 0:he.code)?me.location.country.code.toLowerCase():(null==(xe=null==me?void 0:me.country_details)?void 0:xe.code)?me.country_details.code.toLowerCase():(null==(pe=null==(ge=null==(fe=null==ue?void 0:ue.owner)?void 0:fe.location)?void 0:ge.country)?void 0:pe.code)?ue.owner.location.country.code.toLowerCase():(null==(ye=null==(ve=null==ue?void 0:ue.location)?void 0:ve.country)?void 0:ye.code)?ue.location.country.code.toLowerCase():(null==(we=null==ue?void 0:ue.country_details)?void 0:we.code)?ue.country_details.code.toLowerCase():null);var ue,me,be,he,xe,fe,ge,pe,ve,ye,we;const je=(Ne=ce)?`https://www.f-cdn.com/assets/main/en/assets/flags/${Ne}.png`:null;var Ne;const ke=(null==N?void 0:N.past_projects)||0,Ce=(null==N?void 0:N.completed_projects)||0,Se=function(e,t){if(!e||!t)return 0;const r=e/t;return r>4?5:r>3?4:r>2?3:r>1.5?2:isNaN(r)?0:1}(ke,Ce),Ie=ke/Ce;return isNaN(Ie)||Ie.toFixed(1),o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black bg-opacity-50",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:o.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg shadow-xl w-[600px] max-h-[80vh] flex flex-col overflow-hidden",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-2.5 border-b border-dark-border cursor-move bg-dark-bg",children:[o.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[o.jsx("i",{className:"fas fa-folder"}),"Project Information"]}),o.jsx("button",{onClick:r,className:"text-2xl text-white hover:text-gray-300 transition-colors self-start mt-0.5",children:"Ã—"})]}),o.jsxs("div",{className:"p-4 overflow-y-auto bg-dark-card [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]",children:[o.jsxs("div",{className:"mb-4 p-3 bg-dark-bg rounded border border-dark-border",children:[o.jsxs("h4",{className:"text-sm font-semibold text-white mb-3 flex items-center gap-2",children:[o.jsx("i",{className:"fas fa-info-circle text-blue-500"}),"Project Information"]}),o.jsxs("div",{className:"grid grid-cols-[2fr_1fr] gap-2 mb-2",children:[o.jsxs("div",{className:"pr-2 border-r border-dark-border",children:[o.jsx("span",{className:"text-xs text-gray-400",children:"SEO URL:"}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("span",{className:"text-sm text-white",children:oe}),o.jsx("button",{onClick:()=>te(oe),className:"text-xs px-1 hover:bg-dark-card rounded text-white",title:"Copy",children:o.jsx("i",{className:"fas fa-copy"})})]})]}),o.jsxs("div",{className:"pl-2",children:[o.jsx("span",{className:"text-xs text-gray-400",children:"Project ID:"}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("span",{className:"text-sm text-white",children:j.id||"N/A"}),o.jsx("button",{onClick:()=>{var e;return te(null==(e=j.id)?void 0:e.toString())},className:"text-xs px-1 hover:bg-dark-card rounded text-white",title:"Copy",children:o.jsx("i",{className:"fas fa-copy"})})]})]})]}),o.jsx("div",{className:"pt-2 border-t border-dark-border",children:o.jsxs("div",{className:"grid grid-cols-[2fr_1fr] gap-2",children:[o.jsxs("div",{className:"pr-2 border-r border-dark-border",children:[o.jsx("span",{className:"text-xs text-gray-400",children:"Type:"}),o.jsx("div",{className:"text-sm text-white",children:j.type||"N/A"})]}),o.jsxs("div",{className:"pl-2",children:[o.jsx("span",{className:"text-xs text-gray-400",children:"Budget:"}),o.jsx("div",{className:"text-sm text-white font-semibold",children:j.budget?o.jsxs(o.Fragment,{children:[ie," ",j.budget.minimum||0," - ",ie," ",j.budget.maximum||0]}):"N/A"})]})]})}),o.jsx("div",{className:"pt-2 border-t border-dark-border",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-xs text-gray-400",children:"Currency:"}),o.jsx("div",{className:"text-sm text-white font-semibold",children:ie||"N/A"})]}),o.jsx("button",{onClick:()=>{var r;const s=(null==(r=null==j?void 0:j.currency)?void 0:r.code)||(null==j?void 0:j.currency_code);s?(async()=>{const r=await e.get("filters")||{},a=r.hideCurrencies||"",n=a?u.parseCommaSeparated(a).map(e=>e.trim().toUpperCase()):[],o=s.toUpperCase();if(B){const a=n.filter(e=>e!==o);await e.set("filters",{...r,hideCurrencies:a.join(", ")}),t.success(`Currency "${s}" removed from block list`,!0)}else n.includes(o)||(n.push(o),await e.set("filters",{...r,hideCurrencies:n.join(", ")}),t.success(`Currency "${s}" added to block list`,!0))})():t.error("Cannot block currency: currency code not available")},disabled:!(null==(l=null==j?void 0:j.currency)?void 0:l.code)&&!(null==j?void 0:j.currency_code),className:`px-3 py-1 text-xs rounded ${B?"bg-green-600":"bg-dark-border"} text-white hover:opacity-80 disabled:opacity-50 disabled:cursor-not-allowed`,children:B?"Unblock Currency":"Block Currency"})]})})]}),N?o.jsxs("div",{className:"mb-4 p-3 bg-dark-bg rounded border border-dark-border",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[N.logo&&o.jsx("img",{src:N.logo,className:"w-12 h-12 rounded-full",alt:"Employer Logo"}),o.jsx("div",{children:o.jsx("a",{href:`https://www.freelancer.com/u/${N.name}?w=f`,target:"_blank",rel:"noopener noreferrer",className:"font-bold text-blue-400 hover:text-blue-300",children:N.name})})]}),o.jsx("button",{onClick:()=>{var r;const s=(null==N?void 0:N.name)||(null==(r=null==j?void 0:j.owner_id)?void 0:r.toString())||"";s?(async()=>{const r=await e.get("filters")||{},a=r.hideClients||"",n=a?u.parseCommaSeparated(a).map(e=>e.trim()):[];if(T){const a=n.filter(e=>e.toLowerCase()!==s.toLowerCase());await e.set("filters",{...r,hideClients:a.join(", ")}),t.success(`Client "${s}" removed from block list`,!0)}else n.some(e=>e.toLowerCase()===s.toLowerCase())||(n.push(s),await e.set("filters",{...r,hideClients:n.join(", ")}),t.success(`Client "${s}" added to block list`,!0))})():t.error("Cannot block client: no name or ID available",!0)},className:`px-3 py-1 text-xs rounded ${T?"bg-green-600":"bg-dark-border"} text-white hover:opacity-80`,children:T?"Unblock Client":"Block Client"})]}),o.jsxs("div",{className:"pt-2 border-t border-dark-border",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[o.jsxs("div",{className:"pr-2 border-r border-dark-border",children:[o.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[o.jsx("i",{className:"fas fa-briefcase text-xs text-gray-400"}),o.jsx("span",{className:"text-xs text-gray-400",children:"Projects:"})]}),o.jsxs("div",{className:"text-sm text-white font-semibold",children:[Ce,"/",ke]})]}),o.jsxs("div",{className:"pl-2",children:[o.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[o.jsx("i",{className:"fas fa-comments text-xs text-gray-400"}),o.jsx("span",{className:"text-xs text-gray-400",children:"Reviews:"})]}),o.jsx("div",{className:"text-sm text-white font-semibold",children:(null==(d=null==(i=null==N?void 0:N.employer_reputation)?void 0:i.entire_history)?void 0:d.reviews)||Ce||"N/A"})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-2 border-t border-dark-border",children:[o.jsxs("div",{className:"pr-2 border-r border-dark-border",children:[o.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[o.jsx("i",{className:"fas fa-star text-xs text-gray-400"}),o.jsx("span",{className:"text-xs text-gray-400",children:"Rating:"})]}),o.jsx("div",{className:"text-sm text-white font-semibold",children:(null==N?void 0:N.overall_rating)?`${N.overall_rating.toFixed(1)}/5.0`:"N/A"})]}),o.jsxs("div",{className:"pl-2",children:[o.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[o.jsx("i",{className:"fas fa-dollar-sign text-xs text-gray-400"}),o.jsx("span",{className:"text-xs text-gray-400",children:"Earnings Score:"})]}),o.jsx("div",{className:"text-sm text-white font-semibold",children:(null==N?void 0:N.earnings_score)?"number"==typeof N.earnings_score?N.earnings_score.toFixed(2):N.earnings_score:"N/A"})]})]})]}),o.jsx("div",{className:"p-2 bg-dark-card rounded text-xs text-gray-400 italic border border-dark-border mb-2",children:h[Se].title}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-xs text-gray-400",children:"Country:"}),je&&o.jsx("img",{src:je,className:"w-5 h-4 object-cover rounded",alt:de,onError:e=>e.target.style.display="none"}),o.jsx("span",{className:"text-sm text-white",children:de})]}),o.jsx("button",{onClick:()=>{const r=ee(j,N);r&&"Unknown"!==r?(async()=>{const s=await e.get("filters")||{},a=s.hideCountries||"",n=a?u.parseCommaSeparated(a).map(e=>e.trim()):[];if(M){const a=n.filter(e=>e.toLowerCase()!==r.toLowerCase());await e.set("filters",{...s,hideCountries:a.join(", ")}),t.success(`Country "${r}" removed from block list`,!0)}else n.some(e=>e.toLowerCase()===r.toLowerCase())||(n.push(r),await e.set("filters",{...s,hideCountries:n.join(", ")}),t.success(`Country "${r}" added to block list`,!0))})():t.error("Cannot block country: country name not available")},className:`px-3 py-1 text-xs rounded ${M?"bg-green-600":"bg-dark-border"} text-white hover:opacity-80`,children:M?"Unblock Country":"Block Country"})]})]}):o.jsx("div",{className:"mb-4 p-3 bg-dark-bg rounded text-sm text-gray-400",children:"Employer details not available"}),k&&C&&o.jsxs("div",{className:"mb-4 p-3 bg-green-900 bg-opacity-30 border border-green-500 rounded",children:[o.jsxs("div",{className:"text-sm text-green-400 font-bold mb-1 flex items-center gap-2",children:[o.jsx("i",{className:"fas fa-check-circle"}),"You have already placed a bid on this project"]}),o.jsxs("div",{className:"text-xs text-green-300",children:[o.jsxs("span",{className:"flex items-center gap-2 mb-1",children:[o.jsx("i",{className:"fas fa-dollar-sign"}),"Bid Amount: ",ie," ",(null==(b=null==(m=C.bids)?void 0:m[0])?void 0:b.amount)||"N/A"]}),o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx("i",{className:"fas fa-calendar"}),"Submitted: ",(null==(f=null==(x=C.bids)?void 0:x[0])?void 0:f.submitdate)?new Date(1e3*C.bids[0].submitdate).toLocaleString():"N/A"]})]})]}),k&&X&&!q&&o.jsx("div",{className:"mb-4 p-3 bg-dark-bg rounded border border-dark-border",children:o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("h4",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[o.jsx("i",{className:"fas fa-comments text-blue-400"}),"Chat with Project"]}),Q?o.jsxs("span",{className:"px-3 py-1.5 text-xs font-semibold rounded bg-gray-600 text-white flex items-center gap-2",title:"Thread already in chat list",children:[o.jsx("i",{className:"fas fa-check"}),"In Chat List"]}):o.jsxs("button",{onClick:()=>{X&&j&&P&&(async()=>{var t;const r=(await e.get("chat")||{threads:[]}).threads||[];r.find(e=>e.threadId===X)||(r.push({threadId:X,project:j,profile:P,userId:null==D?void 0:D.freelancer_user_id,clientId:j.owner_id||(null==(t=j.owner)?void 0:t.id),chatHistory:[]}),await e.set("chat",{threads:r}))})()},className:"px-3 py-1.5 text-xs font-semibold rounded bg-green-600 text-white hover:bg-green-700 transition-colors flex items-center gap-2",title:"Add this thread to chat list",children:[o.jsx("i",{className:"fas fa-plus"}),"Add to Chat List"]})]})}),!k&&o.jsxs("div",{className:"mb-4 p-3 bg-dark-bg rounded border border-dark-border",children:[o.jsxs("h4",{className:"text-sm font-semibold text-white mb-3 flex items-center gap-2",children:[o.jsx("i",{className:"fas fa-cog"}),"Operations"]}),H&&$&&o.jsxs("div",{className:"p-3 rounded border mb-3 "+($.valid?"bg-green-900 bg-opacity-30 border-green-500":"bg-red-900 bg-opacity-30 border-red-500"),children:[o.jsxs("div",{className:"text-sm font-semibold flex items-center gap-2 "+($.valid?"text-green-400":"text-red-400"),children:[o.jsx("i",{className:"fas "+($.valid?"fa-check-circle":"fa-times-circle")}),$.valid?"Valid":"Invalid"]}),o.jsx("div",{className:"text-xs text-white mt-1",children:$.message})]}),Y&&o.jsxs("div",{className:"p-3 rounded border mb-3 bg-red-900 bg-opacity-30 border-red-500",children:[o.jsxs("div",{className:"text-sm font-semibold flex items-center gap-2 text-red-400",children:[o.jsx("i",{className:"fas fa-times-circle"}),"Bid Failed"]}),o.jsx("div",{className:"text-xs text-white mt-1",children:Y})]}),o.jsx("div",{className:"flex gap-2 mb-3",children:(null==$?void 0:$.valid)?o.jsx("button",{onClick:async()=>{if(j&&(null==$?void 0:$.matchedProposal)){G(!0),K(null);try{const r=await chrome.runtime.sendMessage({action:"placeBid",project:j,proposal:$.matchedProposal,skipBotStatusCheck:!0});if(!r||!r.success){const e=(null==r?void 0:r.message)||"Failed to place bid";return K(e),void t.error(e)}const s=await e.get("project")||{};await e.set("project",{...s,hasBid:!0}),window.location.reload()}catch(r){const e=r.message||"Failed to place bid";K(e),t.error(e)}finally{G(!1)}}},disabled:z||!j,className:"flex-1 px-3 py-2 text-xs font-semibold rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:z?o.jsxs(o.Fragment,{children:[o.jsx("i",{className:"fas fa-spinner fa-spin"}),"Placing..."]}):o.jsxs(o.Fragment,{children:[o.jsx("i",{className:"fas fa-bullseye"}),"Place Bid"]})}):o.jsx("button",{onClick:async()=>{var e;if(j){O(!0),W(!0),U(null);try{const t=await chrome.runtime.sendMessage({action:"validateProject",project:j,options:{skipAutoValidation:!0}});if(!t||!t.success){const r=(null==t?void 0:t.error)||(null==(e=null==t?void 0:t.result)?void 0:e.reason)||"Failed to validate project";return void U({valid:!1,message:r})}const r=t.result;r.valid?(U({valid:!0,message:"Project is valid and ready to bid!",matchedProposal:r.matchedProposal}),setShowBidLetter(!0)):U({valid:!1,message:r.reason||"Project validation failed"})}catch(t){U({valid:!1,message:t.reason||t.message||"Validation failed"})}finally{O(!1)}}},disabled:_||!j,className:"flex-1 px-3 py-2 text-xs font-semibold rounded bg-gray-600 text-white hover:bg-gray-700 disabled:opacity-60 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:_?o.jsxs(o.Fragment,{children:[o.jsx("i",{className:"fas fa-spinner fa-spin"}),"Validating..."]}):o.jsxs(o.Fragment,{children:[o.jsx("i",{className:"fas fa-check-circle"}),"Validate Project"]})})})]})]})]})})}function f({onClose:t}){const[r,s]=a("logs",{logs:[],unreadCount:0}),l=(null==r?void 0:r.logs)||[],i=(null==r?void 0:r.unreadCount)||0,d=n.useRef(null),c=n.useMemo(()=>{if(!l||0===l.length)return[];return[...l].sort((e,t)=>{const r=e=>{if(!e)return 0;if("number"==typeof e)return e;if("string"==typeof e){const t=Date.parse(e);if(!isNaN(t))return t;const r=Number(e);if(!isNaN(r))return r}return 0},s=r(e.timestamp);return r(t.timestamp)-s})},[l]);n.useEffect(()=>{i>0&&s({...r,unreadCount:0})},[i]);n.useEffect(()=>{d.current&&(d.current.scrollTop=0)},[c]);const u=e=>{switch(e){case"success":return"border-green-500";case"error":return"border-red-500";case"warn":return"border-yellow-500";default:return"border-blue-500"}},m=e=>{switch(e){case"success":return"fa-check-circle";case"error":return"fa-times-circle";case"warn":return"fa-exclamation-triangle";default:return"fa-info-circle"}},b=e=>{switch(e){case"success":return"text-green-500";case"error":return"text-red-500";case"warn":return"text-yellow-500";default:return"text-blue-500"}},h=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleString()}catch(t){return"N/A"}};return o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black bg-opacity-50",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:o.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg shadow-xl w-[600px] max-h-[80vh] flex flex-col overflow-hidden",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-2.5 border-b border-dark-border cursor-move bg-dark-bg",children:[o.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[o.jsx("i",{className:"fas fa-clipboard-list text-yellow-400"}),"Activity Logs"]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:async()=>{await e.set("logs",{logs:[],unreadCount:0})},className:"text-sm text-white hover:text-red-400 transition-colors flex items-center justify-center mr-2",title:"Clear all logs",children:o.jsx("i",{className:"fas fa-trash-alt"})}),o.jsx("button",{onClick:t,className:"text-white hover:text-gray-300 transition-colors",children:o.jsx("i",{className:"fas fa-times text-xl"})})]})]}),o.jsx("div",{className:"p-4 overflow-y-auto bg-dark-card [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]",children:o.jsx("div",{ref:d,className:"bg-dark-bg border border-dark-border p-3 rounded text-sm min-h-[600px] max-h-[600px] overflow-y-auto [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]",children:0===c.length?o.jsxs("div",{className:"mb-2 p-2 bg-dark-card border border-dark-border rounded border-l-4 border-blue-500",children:[o.jsx("div",{className:"text-xs text-gray-400",children:(new Date).toLocaleTimeString()}),o.jsxs("div",{className:"text-white flex items-center gap-2",children:[o.jsx("i",{className:"fas fa-info-circle text-blue-500"}),o.jsx("span",{children:"Bot ready. Click Start to begin bidding."})]})]}):c.map((e,t)=>o.jsxs("div",{className:`mb-2 p-2 bg-dark-card border border-dark-border rounded border-l-4 ${u(e.type)}`,children:[o.jsx("div",{className:"text-xs text-gray-400 flex items-center justify-between",children:o.jsx("span",{children:h(e.timestamp)})}),o.jsxs("div",{className:"text-white flex items-center gap-2",children:[o.jsx("i",{className:`fas ${m(e.type)} ${b(e.type)}`}),o.jsx("span",{children:e.message||"No message"})]})]},e.id||`log-${t}-${e.timestamp}`))})})]})})}function g({onClose:s}){const[l,i,d]=a("telegram",{}),{enabled:c,botToken:u,chatId:m}=l,[b,h]=n.useState(c),[x,f]=n.useState(u||""),[g,p]=n.useState(m||""),[v,y]=n.useState(!1),[w,j]=n.useState(!1),[N,k]=n.useState(null);n.useEffect(()=>{!d&&l&&(h(c),f(u||""),p(m||""))},[c,u,m,l,d]);return o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black bg-opacity-50",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:o.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg shadow-xl w-[600px] max-h-[80vh] flex flex-col overflow-hidden",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-2.5 border-b border-dark-border cursor-move bg-dark-bg",children:[o.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[o.jsx("i",{className:"fas fa-paper-plane text-blue-400"}),"Telegram Settings"]}),o.jsx("button",{onClick:s,className:"text-white hover:text-gray-300 transition-colors",children:o.jsx("i",{className:"fas fa-times text-xl"})})]}),o.jsxs("div",{className:"p-4 overflow-y-auto space-y-4 bg-dark-card [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]",children:[o.jsxs("label",{className:"flex items-center gap-2 p-2 bg-dark-bg border border-dark-border rounded cursor-pointer hover:bg-dark-border transition-all duration-200 "+(w||v?"opacity-60 cursor-not-allowed":""),children:[o.jsx("input",{type:"checkbox",checked:b,onChange:e=>h(e.target.checked),disabled:w||v,className:"w-4 h-4 text-blue-600 bg-dark-card border-dark-border rounded focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all"}),o.jsx("span",{className:"text-sm font-medium text-white",children:"Enable Telegram Notifications"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold mb-1 text-white",children:"Telegram Bot Token"}),o.jsx("input",{type:"text",value:x,onChange:e=>f(e.target.value),placeholder:"1234567890:ABC...",disabled:w||v,className:"w-full px-3 py-2 border border-dark-border rounded-md text-sm bg-dark-bg text-white focus:outline-none focus:border-blue-500 focus:bg-dark-border disabled:opacity-50 disabled:cursor-not-allowed transition-all"}),o.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Get your bot token from @BotFather on Telegram"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold mb-1 text-white",children:"Telegram Chat ID"}),o.jsx("input",{type:"text",value:g,onChange:e=>p(e.target.value),placeholder:"123456789",disabled:w||v,className:"w-full px-3 py-2 border border-dark-border rounded-md text-sm bg-dark-bg text-white focus:outline-none focus:border-blue-500 focus:bg-dark-border disabled:opacity-50 disabled:cursor-not-allowed transition-all"}),o.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Your Telegram user ID or group chat ID"})]}),N&&o.jsx("div",{className:"p-3 rounded text-sm border "+(N.success?"bg-green-900 bg-opacity-30 border-green-500 text-green-300":"bg-red-900 bg-opacity-30 border-red-500 text-red-300"),children:o.jsxs("div",{className:"flex items-center gap-2",children:[N.success?o.jsx("i",{className:"fas fa-check-circle"}):o.jsx("i",{className:"fas fa-times-circle"}),o.jsx("span",{children:N.message})]})}),o.jsx("button",{onClick:async()=>{if(!x.trim()||!g.trim()){return void k({success:!1,message:"Please enter both Bot Token and Chat ID"})}y(!0),k(null);try{const e=await r.testConnection(x.trim(),g.trim());e.success?(k({success:!0,message:e.message||"Telegram connection test successful!"}),t.success("Telegram connection test successful!",!0)):(k({success:!1,message:e.message||"Connection test failed"}),t.error(`Telegram test error: ${e.message}`,!0))}catch(e){const r=e.message||"Connection test failed";k({success:!1,message:r}),t.error(`Telegram test error: ${r}`,!0)}finally{y(!1)}},disabled:v||w,className:"w-full px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-gray-600 transition-all duration-200 flex items-center justify-center gap-2 text-sm font-semibold transform hover:scale-[1.02] active:scale-[0.98] disabled:transform-none disabled:hover:scale-100",children:v?o.jsxs(o.Fragment,{children:[o.jsx("i",{className:"fas fa-spinner fa-spin animate-spin"}),o.jsx("span",{className:"animate-pulse",children:"Testing..."})]}):o.jsxs(o.Fragment,{children:[o.jsx("i",{className:"fas fa-paper-plane"}),"Test Connection"]})}),o.jsx("button",{onClick:async()=>{j(!0);try{await e.set("telegram",{enabled:b,botToken:x.trim(),chatId:g.trim()}),t.success("Telegram settings saved successfully!",!0),setTimeout(()=>{s()},1e3)}catch(r){t.error(`Failed to save settings: ${r.message}`,!0)}finally{j(!1)}},disabled:w||v,className:"w-full px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-blue-500 transition-all duration-200 flex items-center justify-center gap-2 text-sm font-semibold transform hover:scale-[1.02] active:scale-[0.98] disabled:transform-none disabled:hover:scale-100 shadow-md hover:shadow-lg disabled:shadow-none",children:w?o.jsxs(o.Fragment,{children:[o.jsx("i",{className:"fas fa-spinner fa-spin animate-spin"}),o.jsx("span",{className:"animate-pulse",children:"Saving..."})]}):o.jsxs(o.Fragment,{children:[o.jsx("i",{className:"fas fa-save"}),"Save Settings"]})})]})]})})}const p="You are an expert freelance bid writer. Write compelling, professional bids that highlight the freelancer's relevant experience and skills. Keep bids concise (2-3 paragraphs), personalized, and focused on how the freelancer can solve the client's problem.";function v({onClose:r}){const[s,l,i]=a("customai",{}),[d]=a("auth",{}),{enabled:c,provider:u,model:b,maxTokenCount:h,useGithubUrl:x,githubUrl:f,usePortfolioUrl:g,portfolioUrl:v,useProjectLinks:y,systemPrompt:w,projectLinks:j}=s,N=null==d?void 0:d.profile,k=(null==N?void 0:N.membership)||"basic",C=null==N?void 0:N.membership_expires_at,S=!(("premium"===k||"ultra"===k)&&(!C||new Date(C)<new Date))||"premium"!==k&&"ultra"!==k?k:"basic",I="ultra"===S,E="premium"===S,[D,P]=n.useState(c??!1),[R,T]=n.useState(u??"openai"),[F,M]=n.useState(b??"gpt-4o-mini"),[A,B]=n.useState(h??1e3),[L,$]=n.useState(x??!1),[U,_]=n.useState(f??""),[O,z]=n.useState(g??!1),[G,H]=n.useState(v??""),[W,Y]=n.useState(y??!1),[K,X]=n.useState(w??p),[V,q]=n.useState(j??[]),[J,Q]=n.useState(""),[Z,ee]=n.useState(!1),[te,re]=n.useState(!1),[se,ae]=n.useState(null);n.useEffect(()=>{!i&&s&&(P(c??!1),T(u??"openai"),M(b??"gpt-4o-mini"),B(h??1e3),$(x??!1),_(f??""),z(g??!1),H(v??""),Y(y??!1),X(w??p),q(j??[]))},[c,u,b,h,x,f,g,v,y,w,j,s,i]),n.useEffect(()=>{E&&!I&&(T("openai"),M("gpt-4o-mini"),X(p))},[E,I]);const ne=()=>{const e=J.trim();e&&(V.includes(e)||(q([...V,e]),Q("")))};return o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black bg-opacity-50",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:o.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg shadow-xl w-[700px] max-h-[80vh] flex flex-col overflow-hidden",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-2.5 border-b border-dark-border cursor-move bg-dark-bg",children:[o.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[o.jsx("i",{className:"fas fa-robot text-green-400"}),"Custom AI Settings"]}),o.jsx("button",{onClick:r,className:"text-white hover:text-gray-300 transition-colors",children:o.jsx("i",{className:"fas fa-times text-xl"})})]}),o.jsxs("div",{className:"p-4 overflow-y-auto space-y-4 bg-dark-card [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]",children:[o.jsxs("label",{className:"flex items-center gap-2 p-2 bg-dark-bg border border-dark-border rounded cursor-pointer hover:bg-dark-border transition-all duration-200 "+(te||Z?"opacity-60 cursor-not-allowed":""),children:[o.jsx("input",{type:"checkbox",checked:D,onChange:e=>P(e.target.checked),disabled:te||Z,className:"w-4 h-4 text-blue-600 bg-dark-card border-dark-border rounded focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all"}),o.jsx("span",{className:"text-sm font-medium text-white",children:"Enable AI Bid Generation"})]}),o.jsxs("div",{className:"p-3 border border-dark-border rounded-lg bg-dark-bg",children:[o.jsx("label",{className:"block text-sm font-semibold mb-1 text-white",children:"AI Provider"}),o.jsxs("select",{value:R,onChange:e=>{const t=e.target.value;T(t),"openai"===t?M("gpt-4o-mini"):"anthropic"===t&&M("claude-3-haiku-20240307")},disabled:te||Z||!I,className:"w-full px-3 py-2 border border-dark-border rounded-md text-sm bg-dark-card text-white focus:outline-none focus:border-blue-500 focus:bg-dark-border disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:[o.jsx("option",{value:"openai",children:"OpenAI"}),o.jsx("option",{value:"anthropic",disabled:!0,children:"Anthropic"})]}),!I&&o.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Available for Ultra membership only"})]}),o.jsxs("div",{className:"p-3 border border-dark-border rounded-lg bg-dark-bg",children:[o.jsx("label",{className:"block text-sm font-semibold mb-1 text-white",children:"AI Model"}),o.jsx("select",{value:F,onChange:e=>M(e.target.value),disabled:te||Z||!I,className:"w-full px-3 py-2 border border-dark-border rounded-md text-sm bg-dark-card text-white focus:outline-none focus:border-blue-500 focus:bg-dark-border disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:("openai"===R?E&&!I?[{value:"gpt-4o-mini",label:"GPT-4o Mini"}]:[{value:"gpt-4o",label:"GPT-4o",active:!1},{value:"gpt-4o-mini",label:"GPT-4o Mini",active:!0},{value:"gpt-4-turbo",label:"GPT-4 Turbo",active:!1},{value:"gpt-4",label:"GPT-4",active:!1},{value:"gpt-3.5-turbo",label:"GPT-3.5 Turbo",active:!1}]:"anthropic"===R?[{value:"claude-opus-4-5-20251101",label:"Claude Opus 4.5",active:!1},{value:"claude-sonnet-4-5-20250929",label:"Claude Sonnet 4.5",active:!1},{value:"claude-haiku-4-5-20251001",label:"Claude Haiku 4.5",active:!1},{value:"claude-opus-4-1-20250805",label:"Claude Opus 4.1",active:!1},{value:"claude-opus-4-20250514",label:"Claude Opus 4",active:!1},{value:"claude-sonnet-4-20250514",label:"Claude Sonnet 4",active:!1},{value:"claude-3-5-haiku-20241022",label:"Claude Haiku 3.5",active:!1},{value:"claude-3-haiku-20240307",label:"Claude Haiku 3",active:!1}]:[]).map(e=>o.jsx("option",{value:e.value,disabled:!1===e.active,children:e.label},e.value))}),E&&!I&&o.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Premium membership: GPT-4o Mini only"}),!E&&!I&&o.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Available for Premium/Ultra membership only"})]}),o.jsxs("div",{className:"p-3 border border-dark-border rounded-lg bg-dark-bg",children:[o.jsx("label",{className:"block text-sm font-semibold mb-1 text-white",children:"Max Token Count"}),o.jsx("input",{type:"number",value:A,onChange:e=>B(Number(e.target.value)),min:"100",max:"4000",disabled:te||Z,className:"w-full px-3 py-2 border border-dark-border rounded-md text-sm bg-dark-card text-white focus:outline-none focus:border-blue-500 focus:bg-dark-border disabled:opacity-50 disabled:cursor-not-allowed transition-all"}),o.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Maximum number of tokens for generated bid letters (100-4000)"})]}),o.jsxs("div",{className:"p-3 border border-dark-border rounded-lg bg-dark-bg",children:[o.jsxs("label",{className:"flex items-center gap-2 mb-2 cursor-pointer "+(te||Z?"opacity-60 cursor-not-allowed":""),children:[o.jsx("input",{type:"checkbox",checked:L,onChange:e=>$(e.target.checked),disabled:te||Z,className:"w-4 h-4 text-blue-600 bg-dark-card border-dark-border rounded focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all"}),o.jsx("span",{className:"text-sm font-semibold text-white",children:"Add GitHub URL"})]}),o.jsx("input",{type:"url",value:U,onChange:e=>_(e.target.value),placeholder:"https://github.com/username",disabled:te||Z||!L,className:"w-full px-3 py-2 border border-dark-border rounded-md text-sm bg-dark-card text-white focus:outline-none focus:border-blue-500 focus:bg-dark-border disabled:opacity-50 disabled:cursor-not-allowed transition-all"}),o.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Your GitHub profile URL to include in bid letters"})]}),o.jsxs("div",{className:"p-3 border border-dark-border rounded-lg bg-dark-bg",children:[o.jsxs("label",{className:"flex items-center gap-2 mb-2 cursor-pointer "+(te||Z?"opacity-60 cursor-not-allowed":""),children:[o.jsx("input",{type:"checkbox",checked:O,onChange:e=>z(e.target.checked),disabled:te||Z,className:"w-4 h-4 text-blue-600 bg-dark-card border-dark-border rounded focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all"}),o.jsx("span",{className:"text-sm font-semibold text-white",children:"Add Portfolio URL"})]}),o.jsx("input",{type:"url",value:G,onChange:e=>H(e.target.value),placeholder:"https://yourportfolio.com",disabled:te||Z||!O,className:"w-full px-3 py-2 border border-dark-border rounded-md text-sm bg-dark-card text-white focus:outline-none focus:border-blue-500 focus:bg-dark-border disabled:opacity-50 disabled:cursor-not-allowed transition-all"}),o.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Your portfolio website URL to include in bid letters"})]}),o.jsxs("div",{className:"p-3 border border-dark-border rounded-lg bg-dark-bg",children:[o.jsx("label",{className:"block text-sm font-semibold mb-1 text-white",children:"System Prompt"}),o.jsx("textarea",{value:K,onChange:e=>X(e.target.value),placeholder:"Enter system prompt",rows:"4",disabled:te||Z||!I,className:"w-full px-3 py-2 border border-dark-border rounded-md text-sm bg-dark-card text-white focus:outline-none focus:border-blue-500 focus:bg-dark-border disabled:opacity-50 disabled:cursor-not-allowed transition-all resize-y"}),!I&&o.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Available for Ultra membership only. Premium uses default prompt."})]}),o.jsxs("div",{className:"p-3 border border-dark-border rounded-lg bg-dark-bg",children:[o.jsxs("label",{className:"flex items-center gap-2 mb-2 cursor-pointer "+(te||Z||!I?"opacity-60 cursor-not-allowed":""),children:[o.jsx("input",{type:"checkbox",checked:W,onChange:e=>Y(e.target.checked),disabled:te||Z||!I,className:"w-4 h-4 text-blue-600 bg-dark-card border-dark-border rounded focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all"}),o.jsx("span",{className:"text-sm font-semibold text-white",children:"Enable Project Links"})]}),!I&&o.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"Available for Ultra membership only"}),I&&o.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"Include project links in bid letters when enabled"}),I&&o.jsxs("div",{className:"flex gap-2 mb-3 "+(W?"":"opacity-50"),children:[o.jsx("input",{type:"url",value:J,onChange:e=>Q(e.target.value),onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),ne())},placeholder:"https://example.com/project",disabled:te||Z||!W,className:"flex-1 px-3 py-2 border border-dark-border rounded-md text-sm bg-dark-card text-white focus:outline-none focus:border-blue-500 focus:bg-dark-border disabled:opacity-50 disabled:cursor-not-allowed transition-all"}),o.jsx("button",{onClick:ne,disabled:te||Z||!J.trim()||!W,className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-blue-500 transition-all text-sm font-semibold",children:o.jsx("i",{className:"fas fa-plus"})})]}),o.jsx("div",{className:"space-y-2 "+(W?"":"opacity-50"),children:0===V.length?o.jsx("p",{className:"text-xs text-gray-400 italic",children:"No project links added"}):V.map((e,t)=>o.jsxs("div",{className:"flex items-center gap-2 p-2 bg-dark-card border border-dark-border rounded",children:[o.jsx("span",{className:"flex-1 text-sm text-white truncate",children:e}),I&&o.jsx("button",{onClick:()=>(e=>{q(V.filter((t,r)=>r!==e))})(t),disabled:te||Z||!W,className:"p-1.5 text-red-400 hover:bg-dark-border rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Remove link",children:o.jsx("i",{className:"fas fa-times text-sm"})})]},t))})]}),se&&o.jsx("div",{className:"p-3 rounded text-sm border "+(se.success?"bg-green-900 bg-opacity-30 border-green-500 text-green-300":"bg-red-900 bg-opacity-30 border-red-500 text-red-300"),children:o.jsxs("div",{className:"flex flex-col gap-2",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[se.success?o.jsx("i",{className:"fas fa-check-circle"}):o.jsx("i",{className:"fas fa-times-circle"}),o.jsx("span",{children:se.message})]}),se.success&&se.response&&o.jsxs("div",{className:"mt-2 p-2 bg-dark-bg rounded border border-dark-border text-white text-xs",children:[o.jsx("div",{className:"font-semibold mb-1 text-green-400",children:"Generated Bid:"}),o.jsx("div",{className:"whitespace-pre-wrap",children:se.response})]})]})}),o.jsx("button",{onClick:async()=>{ee(!0),ae(null);try{const e="We are looking for an experienced developer to help build a responsive web application. The project involves creating a modern dashboard with user authentication, data visualization, and API integration.",r="I am a full-stack developer with 5+ years of experience in web development. I specialize in React, Node.js, and PostgreSQL.",s=await m.generateBid({provider:R||"openai",model:F||"gpt-4o-mini",max_token_count:A||1e3,system_prompt:K||p,project_description:e,profile_description:r,project_title:"Web Application Development"});if(!s.success||!s.bidText)throw new Error(s.error||"AI function test failed");ae({success:!0,message:"AI function test successful!",response:s.bidText}),t.success("AI function test successful!",!0)}catch(e){const r=e.message||"AI function test failed";ae({success:!1,message:r}),t.error(`AI test error: ${r}`,!0)}finally{ee(!1)}},disabled:Z||te,className:"w-full px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-gray-600 transition-all duration-200 flex items-center justify-center gap-2 text-sm font-semibold transform hover:scale-[1.02] active:scale-[0.98] disabled:transform-none disabled:hover:scale-100",children:Z?o.jsxs(o.Fragment,{children:[o.jsx("i",{className:"fas fa-spinner fa-spin animate-spin"}),o.jsx("span",{className:"animate-pulse",children:"Testing..."})]}):o.jsxs(o.Fragment,{children:[o.jsx("i",{className:"fas fa-flask"}),"Test AI Function"]})}),o.jsx("button",{onClick:async()=>{re(!0);try{await e.set("customai",{enabled:D,provider:R,model:F,maxTokenCount:A,useGithubUrl:L,githubUrl:U.trim(),usePortfolioUrl:O,portfolioUrl:G.trim(),useProjectLinks:W,systemPrompt:I?K:p,projectLinks:V}),t.success("AI settings saved successfully!",!0),setTimeout(()=>{r()},1e3)}catch(s){t.error(`Failed to save settings: ${s.message}`,!0)}finally{re(!1)}},disabled:te||Z,className:"w-full px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-blue-500 transition-all duration-200 flex items-center justify-center gap-2 text-sm font-semibold transform hover:scale-[1.02] active:scale-[0.98] disabled:transform-none disabled:hover:scale-100 shadow-md hover:shadow-lg disabled:shadow-none",children:te?o.jsxs(o.Fragment,{children:[o.jsx("i",{className:"fas fa-spinner fa-spin animate-spin"}),o.jsx("span",{className:"animate-pulse",children:"Saving..."})]}):o.jsxs(o.Fragment,{children:[o.jsx("i",{className:"fas fa-save"}),"Save Settings"]})})]})]})})}function y({onClose:r}){const[s,l,i]=a("settings",{}),[d,c]=n.useState(20),[u,m]=n.useState(20),[b,h]=n.useState(0),[x,f]=n.useState(!1),[g,p]=n.useState(!1),[v,y]=n.useState(!1);n.useEffect(()=>{!i&&s&&(c(s.placeBidDelay||20),m(s.apiPullDelay||20),h(s.autoBotCount||0),f(s.openInNewTab||!1),p(s.openProjectModal||!1))},[s,i]);return o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black bg-opacity-50",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:o.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg shadow-xl w-[600px] max-h-[80vh] flex flex-col overflow-hidden",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-2.5 border-b border-dark-border cursor-move bg-dark-bg",children:[o.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[o.jsx("i",{className:"fas fa-gear text-gray-400"}),"Settings"]}),o.jsx("button",{onClick:r,className:"text-white hover:text-gray-300 transition-colors",children:o.jsx("i",{className:"fas fa-times text-xl"})})]}),o.jsxs("div",{className:"p-4 overflow-y-auto space-y-4 bg-dark-card [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]",children:[o.jsxs("div",{className:"p-3 border border-dark-border rounded-lg bg-dark-bg",children:[o.jsx("label",{className:"block text-sm font-semibold mb-3 text-white",children:"Timing Settings"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold mb-1 text-white",children:["Place Bid Delay (seconds) ",o.jsx("span",{className:"text-gray-400",children:"(min: 10)"})]}),o.jsx("input",{type:"number",value:d,onChange:e=>{const t=Number(e.target.value);c(t>=10?t:10)},min:"10",disabled:v,className:"w-full px-3 py-2 border border-dark-border rounded-md text-sm bg-dark-card text-white focus:outline-none focus:border-blue-500 focus:bg-dark-border disabled:opacity-50 disabled:cursor-not-allowed transition-all"}),o.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Time to wait before placing a bid on a project"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-semibold mb-1 text-white",children:["API Pull Delay (seconds) ",o.jsx("span",{className:"text-gray-400",children:"(min: 15)"})]}),o.jsx("input",{type:"number",value:u,onChange:e=>{const t=Number(e.target.value);m(t>=15?t:15)},min:"15",disabled:v,className:"w-full px-3 py-2 border border-dark-border rounded-md text-sm bg-dark-card text-white focus:outline-none focus:border-blue-500 focus:bg-dark-border disabled:opacity-50 disabled:cursor-not-allowed transition-all"}),o.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Time between API calls to get new projects"})]})]})]}),o.jsxs("div",{className:"p-3 border border-dark-border rounded-lg bg-dark-bg",children:[o.jsx("label",{className:"block text-sm font-semibold mb-3 text-white",children:"Bot Control"}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold mb-1 text-white",children:"Auto Bid Count"}),o.jsx("input",{type:"number",value:b,onChange:e=>h(Number(e.target.value)),min:"0",disabled:v,className:"w-full px-3 py-2 border border-dark-border rounded-md text-sm bg-dark-card text-white focus:outline-none focus:border-blue-500 focus:bg-dark-border disabled:opacity-50 disabled:cursor-not-allowed transition-all"}),o.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Stop bot after this many bids (0 = no limit)"})]})]}),o.jsxs("div",{className:"p-3 border border-dark-border rounded-lg bg-dark-bg",children:[o.jsx("label",{className:"block text-sm font-semibold mb-3 text-white",children:"Feature Flags"}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"flex items-center gap-2 p-2 bg-dark-card border border-dark-border rounded cursor-pointer hover:bg-dark-border transition-all duration-200 "+(v?"opacity-60 cursor-not-allowed":""),children:[o.jsx("input",{type:"checkbox",checked:x,onChange:e=>f(e.target.checked),disabled:v,className:"w-4 h-4 text-blue-600 bg-dark-bg border-dark-border rounded focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all"}),o.jsx("span",{className:"text-sm font-medium text-white",children:"Open Project in New Tab"})]}),o.jsxs("label",{className:"flex items-center gap-2 p-2 bg-dark-card border border-dark-border rounded cursor-pointer hover:bg-dark-border transition-all duration-200 "+(v?"opacity-60 cursor-not-allowed":""),children:[o.jsx("input",{type:"checkbox",checked:g,onChange:e=>p(e.target.checked),disabled:v,className:"w-4 h-4 text-blue-600 bg-dark-bg border-dark-border rounded focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all"}),o.jsx("span",{className:"text-sm font-medium text-white",children:"Open Project Modal when opening Freelancer project page"})]})]})]}),o.jsx("button",{onClick:async()=>{const a=Math.max(10,d),n=Math.max(15,u);y(!0);try{await e.set("settings",{...s,placeBidDelay:a,apiPullDelay:n,autoBotCount:b,openInNewTab:x,openProjectModal:g}),t.success("Settings saved successfully!",!0),setTimeout(()=>{r()},1e3)}catch(o){t.error(`Failed to save settings: ${o.message}`,!0)}finally{y(!1)}},disabled:v,className:"w-full px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-blue-500 transition-all duration-200 flex items-center justify-center gap-2 text-sm font-semibold transform hover:scale-[1.02] active:scale-[0.98] disabled:transform-none disabled:hover:scale-100 shadow-md hover:shadow-lg disabled:shadow-none",children:v?o.jsxs(o.Fragment,{children:[o.jsx("i",{className:"fas fa-spinner fa-spin animate-spin"}),o.jsx("span",{className:"animate-pulse",children:"Saving..."})]}):o.jsxs(o.Fragment,{children:[o.jsx("i",{className:"fas fa-save"}),"Save Settings"]})})]})]})})}function w({value:e="",onChange:t,placeholder:r="Add item...",disabled:s=!1,separator:a=",",className:l=""}){const[i,d]=n.useState([]),[c,u]=n.useState(""),m=n.useRef(null);n.useEffect(()=>{if(e){const t=e.split(a).map(e=>e.trim()).filter(e=>e.length>0);d(t)}else d([])},[e,a]);const b=e=>{d(e);const r=e.join(a);t(r)},h=e=>{const t=e.trim();t&&!i.includes(t)&&(b([...i,t]),u(""))},x=e=>{b(i.filter(t=>t!==e))};return o.jsxs("div",{className:`flex flex-wrap gap-2 p-3 border border-dark-border rounded-md bg-dark-bg focus-within:border-blue-500 focus-within:bg-dark-border transition-all ${s?"opacity-50 cursor-not-allowed":""} ${l}`,children:[i.map((e,t)=>o.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-dark-card border border-dark-border text-white text-xs font-medium rounded",children:[o.jsx("span",{children:e}),o.jsx("button",{type:"button",onClick:()=>!s&&x(e),disabled:s,className:"hover:bg-dark-border rounded p-0.5 transition-colors focus:outline-none focus:ring-1 focus:ring-blue-400 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-transparent","aria-label":`Remove ${e}`,children:o.jsx("i",{className:"fas fa-times text-[10px]"})})]},t)),o.jsx("input",{ref:m,type:"text",value:c,onChange:e=>u(e.target.value),onKeyDown:e=>{s||("Enter"===e.key||e.key===a?(e.preventDefault(),c.trim()&&h(c)):"Backspace"===e.key&&!c&&i.length>0&&x(i[i.length-1]))},onBlur:()=>{c.trim()&&h(c)},onPaste:e=>{if(s)return;e.preventDefault();const t=e.clipboardData.getData("text").split(a).map(e=>e.trim()).filter(e=>e.length>0);if(t.length>0){const e=[...i];t.forEach(t=>{e.includes(t)||e.push(t)}),b(e),u("")}},placeholder:0===i.length?r:"",disabled:s,className:"flex-1 min-w-[120px] bg-transparent text-white text-sm outline-none placeholder:text-gray-500 disabled:cursor-not-allowed"})]})}function j({onClose:r}){const[s,l,i]=a("filters",{}),[d,c]=n.useState(!1),[u,m]=n.useState((null==s?void 0:s.keywords)||""),[b,h]=n.useState((null==s?void 0:s.minBudget)||10),[x,f]=n.useState((null==s?void 0:s.maxBudget)||1e4),[g,p]=n.useState((null==s?void 0:s.minRate)||5),[v,y]=n.useState((null==s?void 0:s.maxRate)||100),[j,k]=n.useState((null==s?void 0:s.totalBids)||0),[C,S]=n.useState((null==s?void 0:s.hideCurrencies)||""),[I,E]=n.useState((null==s?void 0:s.hideCountries)||""),[D,P]=n.useState((null==s?void 0:s.hideClients)||""),[R,T]=n.useState(void 0===(null==s?void 0:s.searchInTitle)||s.searchInTitle),[F,M]=n.useState(void 0===(null==s?void 0:s.searchInDescription)||s.searchInDescription),[A,B]=n.useState(void 0===(null==s?void 0:s.searchInSkills)||s.searchInSkills),[L,$]=n.useState(void 0===(null==s?void 0:s.hourlyProject)||s.hourlyProject),[U,_]=n.useState(void 0===(null==s?void 0:s.fixedProject)||s.fixedProject),[O,z]=n.useState(void 0===(null==s?void 0:s.recruiterProject)||s.recruiterProject),[G,H]=n.useState(void 0===(null==s?void 0:s.ndaIpProject)||s.ndaIpProject),[W,Y]=n.useState(void 0!==(null==s?void 0:s.projectPostTimeMinutes)?s.projectPostTimeMinutes:0),[K,X]=n.useState(!1);n.useEffect(()=>{!i&&s&&(m(s.keywords||""),h(s.minBudget||10),f(s.maxBudget||1e4),p(s.minRate||5),y(s.maxRate||100),k(s.totalBids||0),S(s.hideCurrencies||""),E(s.hideCountries||""),P(s.hideClients||""),T(void 0===s.searchInTitle||s.searchInTitle),M(void 0===s.searchInDescription||s.searchInDescription),B(void 0===s.searchInSkills||s.searchInSkills),$(void 0===s.hourlyProject||s.hourlyProject),_(void 0===s.fixedProject||s.fixedProject),z(void 0===s.recruiterProject||s.recruiterProject),H(void 0===s.ndaIpProject||s.ndaIpProject),Y(void 0!==s.projectPostTimeMinutes?s.projectPostTimeMinutes:0))},[s]);return o.jsxs(o.Fragment,{children:[d&&o.jsx(N,{onClose:()=>c(!1)}),o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black bg-opacity-50",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:o.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg shadow-xl w-[700px] max-h-[80vh] flex flex-col overflow-hidden",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-2.5 border-b border-dark-border cursor-move bg-dark-bg",children:[o.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[o.jsx("i",{className:"fas fa-filter text-orange-400"}),"Filters"]}),o.jsx("button",{onClick:r,className:"text-white hover:text-gray-300 transition-colors",children:o.jsx("i",{className:"fas fa-times text-xl"})})]}),o.jsxs("div",{className:"p-4 overflow-y-auto space-y-4 bg-dark-card [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]",children:[o.jsxs("div",{className:"p-3 border border-dark-border rounded-lg bg-dark-bg",children:[o.jsx("label",{className:"block text-sm font-semibold mb-2 text-white",children:"Keywords *"}),o.jsx(w,{value:u,onChange:e=>m(e),placeholder:"Add keyword (press Enter or comma)",disabled:K,separator:","}),o.jsx("p",{className:"text-xs text-gray-400 mt-1 mb-2",children:"Projects must contain at least one of these keywords"}),o.jsxs("div",{className:"flex items-center gap-4 p-2 bg-dark-card border border-dark-border rounded mb-2",children:[o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer hover:text-gray-300 transition-colors",children:[o.jsx("input",{type:"checkbox",checked:R,onChange:e=>T(e.target.checked),disabled:K,className:"w-4 h-4 text-blue-600 bg-dark-card border-dark-border rounded focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all"}),o.jsx("span",{className:"text-xs font-medium text-white",children:"Project Title"})]}),o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer hover:text-gray-300 transition-colors",children:[o.jsx("input",{type:"checkbox",checked:F,onChange:e=>M(e.target.checked),disabled:K,className:"w-4 h-4 text-blue-600 bg-dark-card border-dark-border rounded focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all"}),o.jsx("span",{className:"text-xs font-medium text-white",children:"Project Description"})]}),o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer hover:text-gray-300 transition-colors",children:[o.jsx("input",{type:"checkbox",checked:A,onChange:e=>B(e.target.checked),disabled:K,className:"w-4 h-4 text-blue-600 bg-dark-card border-dark-border rounded focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all"}),o.jsx("span",{className:"text-xs font-medium text-white",children:"Project Skills"})]})]}),o.jsx("p",{className:"text-xs text-gray-400",children:"Select where to search for keywords. Keywords will be matched in the selected project fields."})]}),o.jsxs("div",{className:"p-3 border border-dark-border rounded-lg bg-dark-bg",children:[o.jsx("label",{className:"block text-sm font-semibold mb-3 text-white",children:"Project Type & Budget"}),o.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[o.jsxs("label",{className:"flex items-center gap-2 p-2 bg-dark-card border border-dark-border rounded cursor-pointer hover:bg-dark-border transition-colors",children:[o.jsx("input",{type:"checkbox",checked:U,onChange:e=>_(e.target.checked),disabled:K,className:"w-4 h-4 text-blue-600 bg-dark-card border-dark-border rounded focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all"}),o.jsx("span",{className:"text-xs font-medium text-white",children:"Fixed Project"})]}),o.jsxs("label",{className:"flex items-center gap-2 p-2 bg-dark-card border border-dark-border rounded cursor-pointer hover:bg-dark-border transition-colors",children:[o.jsx("input",{type:"checkbox",checked:L,onChange:e=>$(e.target.checked),disabled:K,className:"w-4 h-4 text-blue-600 bg-dark-card border-dark-border rounded focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all"}),o.jsx("span",{className:"text-xs font-medium text-white",children:"Hourly Project"})]}),o.jsxs("label",{className:"flex items-center gap-2 p-2 bg-dark-card border border-dark-border rounded cursor-pointer hover:bg-dark-border transition-colors",children:[o.jsx("input",{type:"checkbox",checked:O,onChange:e=>z(e.target.checked),disabled:K,className:"w-4 h-4 text-blue-600 bg-dark-card border-dark-border rounded focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all"}),o.jsx("span",{className:"text-xs font-medium text-white",children:"Recruiter Project"})]}),o.jsxs("label",{className:"flex items-center gap-2 p-2 bg-dark-card border border-dark-border rounded cursor-pointer hover:bg-dark-border transition-colors",children:[o.jsx("input",{type:"checkbox",checked:G,onChange:e=>H(e.target.checked),disabled:K,className:"w-4 h-4 text-blue-600 bg-dark-card border-dark-border rounded focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all"}),o.jsx("span",{className:"text-xs font-medium text-white",children:"NDA/IP Agreement"})]})]}),G&&o.jsx("div",{className:"mt-3 mb-4",children:o.jsxs("button",{onClick:()=>c(!0),disabled:K,className:"w-full px-3 py-2 border border-blue-500 rounded-md text-sm bg-dark-bg text-blue-400 hover:bg-blue-900/20 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[o.jsx("i",{className:"fas fa-signature"}),"Add Signature Details for NDA/IP Projects"]})}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-xs font-semibold mb-2 text-white",children:"Budget Range (Fixed Projects)"}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs mb-1 text-gray-400",children:"Min Budget ($)"}),o.jsx("input",{type:"number",value:b,onChange:e=>h(Number(e.target.value)),min:"0",disabled:K||!U,className:"w-full px-3 py-2 border border-dark-border rounded-md text-sm bg-dark-bg text-white focus:outline-none focus:border-blue-500 focus:bg-dark-border disabled:opacity-50 disabled:cursor-not-allowed transition-all"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs mb-1 text-gray-400",children:"Max Budget ($)"}),o.jsx("input",{type:"number",value:x,onChange:e=>f(Number(e.target.value)),min:"0",disabled:K||!U,className:"w-full px-3 py-2 border border-dark-border rounded-md text-sm bg-dark-bg text-white focus:outline-none focus:border-blue-500 focus:bg-dark-border disabled:opacity-50 disabled:cursor-not-allowed transition-all"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-semibold mb-2 text-white",children:"Rate Range (Hourly Projects)"}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs mb-1 text-gray-400",children:"Min Rate ($/hr)"}),o.jsx("input",{type:"number",value:g,onChange:e=>p(Number(e.target.value)),min:"0",disabled:K||!L,className:"w-full px-3 py-2 border border-dark-border rounded-md text-sm bg-dark-bg text-white focus:outline-none focus:border-blue-500 focus:bg-dark-border disabled:opacity-50 disabled:cursor-not-allowed transition-all"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs mb-1 text-gray-400",children:"Max Rate ($/hr)"}),o.jsx("input",{type:"number",value:v,onChange:e=>y(Number(e.target.value)),min:"0",disabled:K||!L,className:"w-full px-3 py-2 border border-dark-border rounded-md text-sm bg-dark-bg text-white focus:outline-none focus:border-blue-500 focus:bg-dark-border disabled:opacity-50 disabled:cursor-not-allowed transition-all"})]})]})]})]}),o.jsxs("div",{className:"p-3 border border-dark-border rounded-lg bg-dark-bg",children:[o.jsx("label",{className:"block text-sm font-semibold mb-3 text-white",children:"Other Filters"}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-xs font-semibold mb-1 text-white",children:"Minimum Proposal Count"}),o.jsx("input",{type:"number",value:j,onChange:e=>k(Number(e.target.value)),min:"0",disabled:K,className:"w-full px-3 py-2 border border-dark-border rounded-md text-sm bg-dark-bg text-white focus:outline-none focus:border-blue-500 focus:bg-dark-border disabled:opacity-50 disabled:cursor-not-allowed transition-all"}),o.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Minimum number of proposals required before submitting a bid (0 = no minimum)"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-semibold mb-1 text-white",children:"Project Post Time (Minutes)"}),o.jsx("input",{type:"number",value:W,onChange:e=>Y(Number(e.target.value)),min:"0",disabled:K,className:"w-full px-3 py-2 border border-dark-border rounded-md text-sm bg-dark-bg text-white focus:outline-none focus:border-blue-500 focus:bg-dark-border disabled:opacity-50 disabled:cursor-not-allowed transition-all"}),o.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Minimum minutes since project was posted to allow bidding (0 = no delay)"})]})]}),o.jsxs("div",{className:"p-3 border border-dark-border rounded-lg bg-dark-bg",children:[o.jsx("label",{className:"block text-sm font-semibold mb-3 text-white",children:"Blocklist"}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-xs font-semibold mb-1 text-white",children:"Excluded Countries"}),o.jsx(w,{value:I,onChange:e=>E(e),placeholder:"Add country (press Enter or comma)",disabled:K,separator:","}),o.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Projects from these countries will be rejected"})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-xs font-semibold mb-1 text-white",children:"Excluded Currencies"}),o.jsx(w,{value:C,onChange:e=>S(e),placeholder:"Add currency (press Enter or comma)",disabled:K,separator:","}),o.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Projects using these currencies will be rejected"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-semibold mb-1 text-white",children:"Excluded Clients"}),o.jsx(w,{value:D,onChange:e=>P(e),placeholder:"Add client username (press Enter or comma)",disabled:K,separator:","}),o.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Projects from these clients will be rejected"})]})]}),o.jsx("button",{onClick:async()=>{X(!0);try{await e.set("filters",{keywords:u.trim(),minBudget:b,maxBudget:x,minRate:g,maxRate:v,hideCurrencies:C.trim(),hideCountries:I.trim(),hideClients:D.trim(),totalBids:j,searchInTitle:R,searchInDescription:F,searchInSkills:A,hourlyProject:L,fixedProject:U,recruiterProject:O,ndaIpProject:G,projectPostTimeMinutes:W}),t.success("Filter settings saved successfully!",!0),setTimeout(()=>{r()},1e3)}catch(s){t.error(`Failed to save filters: ${s.message}`,!0)}finally{X(!1)}},disabled:K,className:"w-full px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-blue-500 transition-all duration-200 flex items-center justify-center gap-2 text-sm font-semibold transform hover:scale-[1.02] active:scale-[0.98] disabled:transform-none disabled:hover:scale-100 shadow-md hover:shadow-lg disabled:shadow-none",children:K?o.jsxs(o.Fragment,{children:[o.jsx("i",{className:"fas fa-spinner fa-spin animate-spin"}),o.jsx("span",{className:"animate-pulse",children:"Saving..."})]}):o.jsxs(o.Fragment,{children:[o.jsx("i",{className:"fas fa-save"}),"Save Filters"]})})]})]})})]})}function N({onClose:r}){const[s,a]=n.useState(""),[l,i]=n.useState(""),[d,c]=n.useState(""),[u,m]=n.useState(!1),b=n.useRef(null),h=n.useRef(!1),x=n.useRef({x:0,y:0});n.useEffect(()=>{(async()=>{try{const t=await e.get("signature")||{};if(a(t.fullName||""),i(t.fullAddress||""),t.signature){c(t.signature);const e=b.current;if(e&&t.signature){const r=e.getContext("2d"),s=new Image;s.onload=()=>{r.clearRect(0,0,e.width,e.height),r.drawImage(s,0,0)},s.src=t.signature}}}catch(r){t.error(`Failed to load signature data: ${r.message}`)}})()},[]),n.useEffect(()=>{const e=b.current;if(!e)return;const t=e.getContext("2d");e.width=400,e.height=150,t.strokeStyle="#000000",t.lineWidth=2,t.lineCap="round",t.lineJoin="round",t.fillStyle="#FFFFFF",t.fillRect(0,0,e.width,e.height)},[]);const f=e=>{const t=b.current;if(!t)return null;const r=t.getBoundingClientRect(),s=t.width/r.width,a=t.height/r.height;return e.touches&&e.touches.length>0?{x:(e.touches[0].clientX-r.left)*s,y:(e.touches[0].clientY-r.top)*a}:{x:(e.clientX-r.left)*s,y:(e.clientY-r.top)*a}},g=e=>{e.preventDefault(),h.current=!0;const t=f(e);t&&(x.current=t)},p=e=>{if(e.preventDefault(),!h.current)return;const t=b.current;if(!t)return;const r=t.getContext("2d"),s=f(e);if(!s)return;r.beginPath(),r.moveTo(x.current.x,x.current.y),r.lineTo(s.x,s.y),r.stroke(),x.current=s;const a=t.toDataURL("image/png");c(a)},v=e=>{e.preventDefault(),h.current&&(h.current=!1)};return o.jsx("div",{className:"fixed inset-0 z-[10000] flex items-center justify-center bg-black bg-opacity-50",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:o.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg shadow-xl w-[600px] max-h-[80vh] flex flex-col overflow-hidden",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-2.5 border-b border-dark-border cursor-move bg-dark-bg",children:[o.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[o.jsx("i",{className:"fas fa-signature text-orange-400"}),"Signature Details for NDA/IP Projects"]}),o.jsx("button",{onClick:r,className:"text-white hover:text-gray-300 transition-colors",children:o.jsx("i",{className:"fas fa-times text-xl"})})]}),o.jsxs("div",{className:"p-4 overflow-y-auto space-y-4 bg-dark-card [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold mb-2 text-white",children:"Signature *"}),o.jsx("div",{className:"border-2 border-dark-border rounded-md bg-white p-2",children:o.jsx("canvas",{ref:b,onMouseDown:g,onMouseMove:p,onMouseUp:v,onMouseLeave:v,onTouchStart:g,onTouchMove:p,onTouchEnd:v,className:"w-full cursor-crosshair touch-none",style:{width:"100%",maxWidth:"400px",height:"150px",display:"block",margin:"0 auto"}})}),o.jsxs("div",{className:"flex items-center justify-between mt-2",children:[o.jsxs("button",{onClick:()=>{const e=b.current;if(!e)return;const t=e.getContext("2d");t.fillStyle="#FFFFFF",t.fillRect(0,0,e.width,e.height),c("")},disabled:u,className:"px-3 py-1.5 border border-red-500 rounded-md text-sm bg-dark-bg text-red-400 hover:bg-red-900/20 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[o.jsx("i",{className:"fas fa-eraser mr-1"}),"Clear"]}),o.jsx("p",{className:"text-xs text-gray-400",children:"Draw your signature above"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold mb-2 text-white",children:"Full Name *"}),o.jsx("input",{type:"text",value:s,onChange:e=>a(e.target.value),placeholder:"Enter your full name",disabled:u,className:"w-full px-3 py-2 border border-dark-border rounded-md text-sm bg-dark-bg text-white focus:outline-none focus:border-blue-500 focus:bg-dark-border disabled:opacity-50 disabled:cursor-not-allowed transition-all"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold mb-2 text-white",children:"Full Address *"}),o.jsx("textarea",{value:l,onChange:e=>i(e.target.value),placeholder:"Enter your full address",rows:"3",disabled:u,className:"w-full px-3 py-2 border border-dark-border rounded-md text-sm bg-dark-bg text-white focus:outline-none focus:border-blue-500 focus:bg-dark-border disabled:opacity-50 disabled:cursor-not-allowed transition-all resize-none"})]}),o.jsx("button",{onClick:async()=>{if(s.trim()&&l.trim()&&d){m(!0);try{await e.set("signature",{fullName:s.trim(),fullAddress:l.trim(),signature:d}),t.success("Signature details saved successfully!",!0),setTimeout(()=>{r()},1e3)}catch(a){t.error(`Failed to save signature: ${a.message}`,!0)}finally{m(!1)}}else t.error("Please fill in all signature fields (Full Name, Full Address, and Signature)",!0)},disabled:u,className:"w-full px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-blue-500 transition-all duration-200 flex items-center justify-center gap-2 text-sm font-semibold transform hover:scale-[1.02] active:scale-[0.98] disabled:transform-none disabled:hover:scale-100 shadow-md hover:shadow-lg disabled:shadow-none",children:u?o.jsxs(o.Fragment,{children:[o.jsx("i",{className:"fas fa-spinner fa-spin animate-spin"}),o.jsx("span",{className:"animate-pulse",children:"Saving..."})]}):o.jsxs(o.Fragment,{children:[o.jsx("i",{className:"fas fa-save"}),"Save Signature Details"]})})]})]})})}const k="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;function C(e){const t=Object.prototype.toString.call(e);return"[object Window]"===t||"[object global]"===t}function S(e){return"nodeType"in e}function I(e){var t,r;return e?C(e)?e:S(e)&&null!=(t=null==(r=e.ownerDocument)?void 0:r.defaultView)?t:window:window}function E(e){const{Document:t}=I(e);return e instanceof t}function D(e){return!C(e)&&e instanceof I(e).HTMLElement}function P(e){return e instanceof I(e).SVGElement}function R(e){return e?C(e)?e.document:S(e)?E(e)?e:D(e)||P(e)?e.ownerDocument:document:document:document}const T=k?n.useLayoutEffect:n.useEffect;function F(e){const t=n.useRef(e);return T(()=>{t.current=e}),n.useCallback(function(){for(var e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];return null==t.current?void 0:t.current(...r)},[])}function M(e,t){void 0===t&&(t=[e]);const r=n.useRef(e);return T(()=>{r.current!==e&&(r.current=e)},t),r}function A(e,t){const r=n.useRef();return n.useMemo(()=>{const t=e(r.current);return r.current=t,t},[...t])}function B(e){const t=F(e),r=n.useRef(null),s=n.useCallback(e=>{e!==r.current&&(null==t||t(e,r.current)),r.current=e},[]);return[r,s]}function L(e){const t=n.useRef();return n.useEffect(()=>{t.current=e},[e]),t.current}let $={};function U(e,t){return n.useMemo(()=>{if(t)return t;const r=null==$[e]?0:$[e]+1;return $[e]=r,e+"-"+r},[e,t])}function _(e){return function(t){for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];return s.reduce((t,r)=>{const s=Object.entries(r);for(const[a,n]of s){const r=t[a];null!=r&&(t[a]=r+e*n)}return t},{...t})}}const O=_(1),z=_(-1);function G(e){if(!e)return!1;const{KeyboardEvent:t}=I(e.target);return t&&e instanceof t}function H(e){if(function(e){if(!e)return!1;const{TouchEvent:t}=I(e.target);return t&&e instanceof t}(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return function(e){return"clientX"in e&&"clientY"in e}(e)?{x:e.clientX,y:e.clientY}:null}const W=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[W.Translate.toString(e),W.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:s}=e;return t+" "+r+"ms "+s}}}),Y="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function K(e){return e.matches(Y)?e:e.querySelector(Y)}const X={display:"none"};function V(e){let{id:t,value:r}=e;return l.createElement("div",{id:t,style:X},r)}function q(e){let{id:t,announcement:r,ariaLiveType:s="assertive"}=e;return l.createElement("div",{id:t,style:{position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"},role:"status","aria-live":s,"aria-atomic":!0},r)}const J=n.createContext(null);const Q={draggable:"\n    To pick up a draggable item, press the space bar.\n    While dragging, use the arrow keys to move the item.\n    Press space again to drop the item in its new position, or press escape to cancel.\n  "},Z={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function ee(e){let{announcements:t=Z,container:r,hiddenTextDescribedById:s,screenReaderInstructions:a=Q}=e;const{announce:o,announcement:d}=function(){const[e,t]=n.useState("");return{announce:n.useCallback(e=>{null!=e&&t(e)},[]),announcement:e}}(),c=U("DndLiveRegion"),[u,m]=n.useState(!1);if(n.useEffect(()=>{m(!0)},[]),function(e){const t=n.useContext(J);n.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}(n.useMemo(()=>({onDragStart(e){let{active:r}=e;o(t.onDragStart({active:r}))},onDragMove(e){let{active:r,over:s}=e;t.onDragMove&&o(t.onDragMove({active:r,over:s}))},onDragOver(e){let{active:r,over:s}=e;o(t.onDragOver({active:r,over:s}))},onDragEnd(e){let{active:r,over:s}=e;o(t.onDragEnd({active:r,over:s}))},onDragCancel(e){let{active:r,over:s}=e;o(t.onDragCancel({active:r,over:s}))}}),[o,t])),!u)return null;const b=l.createElement(l.Fragment,null,l.createElement(V,{id:s,value:a.draggable}),l.createElement(q,{id:c,announcement:d}));return r?i.createPortal(b,r):b}var te,re;function se(){}function ae(e,t){return n.useMemo(()=>({sensor:e,options:null!=t?t:{}}),[e,t])}(re=te||(te={})).DragStart="dragStart",re.DragMove="dragMove",re.DragEnd="dragEnd",re.DragCancel="dragCancel",re.DragOver="dragOver",re.RegisterDroppable="registerDroppable",re.SetDroppableDisabled="setDroppableDisabled",re.UnregisterDroppable="unregisterDroppable";const ne=Object.freeze({x:0,y:0});function oe(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function le(e,t){let{data:{value:r}}=e,{data:{value:s}}=t;return r-s}function ie(e,t){let{data:{value:r}}=e,{data:{value:s}}=t;return s-r}function de(e){let{left:t,top:r,height:s,width:a}=e;return[{x:t,y:r},{x:t+a,y:r},{x:t,y:r+s},{x:t+a,y:r+s}]}function ce(e,t){if(!e||0===e.length)return null;const[r]=e;return r[t]}function ue(e,t,r){return void 0===t&&(t=e.left),void 0===r&&(r=e.top),{x:t+.5*e.width,y:r+.5*e.height}}const me=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:s}=e;const a=ue(t,t.left,t.top),n=[];for(const o of s){const{id:e}=o,t=r.get(e);if(t){const r=oe(ue(t),a);n.push({id:e,data:{droppableContainer:o,value:r}})}}return n.sort(le)};function be(e,t){const r=Math.max(t.top,e.top),s=Math.max(t.left,e.left),a=Math.min(t.left+t.width,e.left+e.width),n=Math.min(t.top+t.height,e.top+e.height),o=a-s,l=n-r;if(s<a&&r<n){const r=t.width*t.height,s=e.width*e.height,a=o*l;return Number((a/(r+s-a)).toFixed(4))}return 0}const he=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:s}=e;const a=[];for(const n of s){const{id:e}=n,s=r.get(e);if(s){const r=be(s,t);r>0&&a.push({id:e,data:{droppableContainer:n,value:r}})}}return a.sort(ie)};function xe(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:ne}function fe(e){return function(t){for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];return s.reduce((t,r)=>({...t,top:t.top+e*r.y,bottom:t.bottom+e*r.y,left:t.left+e*r.x,right:t.right+e*r.x}),{...t})}}const ge=fe(1);const pe={ignoreTransform:!1};function ve(e,t){void 0===t&&(t=pe);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:t,transformOrigin:s}=I(e).getComputedStyle(e);t&&(r=function(e,t,r){const s=function(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}(t);if(!s)return e;const{scaleX:a,scaleY:n,x:o,y:l}=s,i=e.left-o-(1-a)*parseFloat(r),d=e.top-l-(1-n)*parseFloat(r.slice(r.indexOf(" ")+1)),c=a?e.width/a:e.width,u=n?e.height/n:e.height;return{width:c,height:u,top:d,right:i+c,bottom:d+u,left:i}}(r,t,s))}const{top:s,left:a,width:n,height:o,bottom:l,right:i}=r;return{top:s,left:a,width:n,height:o,bottom:l,right:i}}function ye(e){return ve(e,{ignoreTransform:!0})}function we(e,t){const r=[];return e?function s(a){if(null!=t&&r.length>=t)return r;if(!a)return r;if(E(a)&&null!=a.scrollingElement&&!r.includes(a.scrollingElement))return r.push(a.scrollingElement),r;if(!D(a)||P(a))return r;if(r.includes(a))return r;const n=I(e).getComputedStyle(a);return a!==e&&function(e,t){void 0===t&&(t=I(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(e=>{const s=t[e];return"string"==typeof s&&r.test(s)})}(a,n)&&r.push(a),function(e,t){return void 0===t&&(t=I(e).getComputedStyle(e)),"fixed"===t.position}(a,n)?r:s(a.parentNode)}(e):r}function je(e){const[t]=we(e,1);return null!=t?t:null}function Ne(e){return k&&e?C(e)?e:S(e)?E(e)||e===R(e).scrollingElement?window:D(e)?e:null:null:null}function ke(e){return C(e)?e.scrollX:e.scrollLeft}function Ce(e){return C(e)?e.scrollY:e.scrollTop}function Se(e){return{x:ke(e),y:Ce(e)}}var Ie,Ee;function De(e){return!(!k||!e)&&e===document.scrollingElement}function Pe(e){const t={x:0,y:0},r=De(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},s={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height};return{isTop:e.scrollTop<=t.y,isLeft:e.scrollLeft<=t.x,isBottom:e.scrollTop>=s.y,isRight:e.scrollLeft>=s.x,maxScroll:s,minScroll:t}}(Ee=Ie||(Ie={}))[Ee.Forward=1]="Forward",Ee[Ee.Backward=-1]="Backward";const Re={x:.2,y:.2};function Te(e,t,r,s,a){let{top:n,left:o,right:l,bottom:i}=r;void 0===s&&(s=10),void 0===a&&(a=Re);const{isTop:d,isBottom:c,isLeft:u,isRight:m}=Pe(e),b={x:0,y:0},h={x:0,y:0},x=t.height*a.y,f=t.width*a.x;return!d&&n<=t.top+x?(b.y=Ie.Backward,h.y=s*Math.abs((t.top+x-n)/x)):!c&&i>=t.bottom-x&&(b.y=Ie.Forward,h.y=s*Math.abs((t.bottom-x-i)/x)),!m&&l>=t.right-f?(b.x=Ie.Forward,h.x=s*Math.abs((t.right-f-l)/f)):!u&&o<=t.left+f&&(b.x=Ie.Backward,h.x=s*Math.abs((t.left+f-o)/f)),{direction:b,speed:h}}function Fe(e){if(e===document.scrollingElement){const{innerWidth:e,innerHeight:t}=window;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}const{top:t,left:r,right:s,bottom:a}=e.getBoundingClientRect();return{top:t,left:r,right:s,bottom:a,width:e.clientWidth,height:e.clientHeight}}function Me(e){return e.reduce((e,t)=>O(e,Se(t)),ne)}const Ae=[["x",["left","right"],function(e){return e.reduce((e,t)=>e+ke(t),0)}],["y",["top","bottom"],function(e){return e.reduce((e,t)=>e+Ce(t),0)}]];class Be{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=we(t),s=Me(r);this.rect={...e},this.width=e.width,this.height=e.height;for(const[a,n,o]of Ae)for(const e of n)Object.defineProperty(this,e,{get:()=>{const t=o(r),n=s[a]-t;return this.rect[e]+n},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Le{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(e=>{var t;return null==(t=this.target)?void 0:t.removeEventListener(...e)})},this.target=e}add(e,t,r){var s;null==(s=this.target)||s.addEventListener(e,t,r),this.listeners.push([e,t,r])}}function $e(e,t){const r=Math.abs(e.x),s=Math.abs(e.y);return"number"==typeof t?Math.sqrt(r**2+s**2)>t:"x"in t&&"y"in t?r>t.x&&s>t.y:"x"in t?r>t.x:"y"in t&&s>t.y}var Ue,_e,Oe,ze;function Ge(e){e.preventDefault()}function He(e){e.stopPropagation()}(_e=Ue||(Ue={})).Click="click",_e.DragStart="dragstart",_e.Keydown="keydown",_e.ContextMenu="contextmenu",_e.Resize="resize",_e.SelectionChange="selectionchange",_e.VisibilityChange="visibilitychange",(ze=Oe||(Oe={})).Space="Space",ze.Down="ArrowDown",ze.Right="ArrowRight",ze.Left="ArrowLeft",ze.Up="ArrowUp",ze.Esc="Escape",ze.Enter="Enter",ze.Tab="Tab";const We={start:[Oe.Space,Oe.Enter],cancel:[Oe.Esc],end:[Oe.Space,Oe.Enter,Oe.Tab]},Ye=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case Oe.Right:return{...r,x:r.x+25};case Oe.Left:return{...r,x:r.x-25};case Oe.Down:return{...r,y:r.y+25};case Oe.Up:return{...r,y:r.y-25}}};class Ke{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new Le(R(t)),this.windowListeners=new Le(I(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Ue.Resize,this.handleCancel),this.windowListeners.add(Ue.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Ue.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:t}=this.props,r=e.node.current;r&&function(e,t){if(void 0===t&&(t=ve),!e)return;const{top:r,left:s,bottom:a,right:n}=t(e);je(e)&&(a<=0||n<=0||r>=window.innerHeight||s>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}(r),t(ne)}handleKeyDown(e){if(G(e)){const{active:t,context:r,options:s}=this.props,{keyboardCodes:a=We,coordinateGetter:n=Ye,scrollBehavior:o="smooth"}=s,{code:l}=e;if(a.end.includes(l))return void this.handleEnd(e);if(a.cancel.includes(l))return void this.handleCancel(e);const{collisionRect:i}=r.current,d=i?{x:i.left,y:i.top}:ne;this.referenceCoordinates||(this.referenceCoordinates=d);const c=n(e,{active:t,context:r.current,currentCoordinates:d});if(c){const t=z(c,d),s={x:0,y:0},{scrollableAncestors:a}=r.current;for(const r of a){const a=e.code,{isTop:n,isRight:l,isLeft:i,isBottom:d,maxScroll:u,minScroll:m}=Pe(r),b=Fe(r),h={x:Math.min(a===Oe.Right?b.right-b.width/2:b.right,Math.max(a===Oe.Right?b.left:b.left+b.width/2,c.x)),y:Math.min(a===Oe.Down?b.bottom-b.height/2:b.bottom,Math.max(a===Oe.Down?b.top:b.top+b.height/2,c.y))},x=a===Oe.Right&&!l||a===Oe.Left&&!i,f=a===Oe.Down&&!d||a===Oe.Up&&!n;if(x&&h.x!==c.x){const e=r.scrollLeft+t.x,n=a===Oe.Right&&e<=u.x||a===Oe.Left&&e>=m.x;if(n&&!t.y)return void r.scrollTo({left:e,behavior:o});s.x=n?r.scrollLeft-e:a===Oe.Right?r.scrollLeft-u.x:r.scrollLeft-m.x,s.x&&r.scrollBy({left:-s.x,behavior:o});break}if(f&&h.y!==c.y){const e=r.scrollTop+t.y,n=a===Oe.Down&&e<=u.y||a===Oe.Up&&e>=m.y;if(n&&!t.x)return void r.scrollTo({top:e,behavior:o});s.y=n?r.scrollTop-e:a===Oe.Down?r.scrollTop-u.y:r.scrollTop-m.y,s.y&&r.scrollBy({top:-s.y,behavior:o});break}}this.handleMove(e,O(z(c,this.referenceCoordinates),s))}}}handleMove(e,t){const{onMove:r}=this.props;e.preventDefault(),r(t)}handleEnd(e){const{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){const{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}function Xe(e){return Boolean(e&&"distance"in e)}function Ve(e){return Boolean(e&&"delay"in e)}Ke.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:s=We,onActivation:a}=t,{active:n}=r;const{code:o}=e.nativeEvent;if(s.start.includes(o)){const t=n.activatorNode.current;return(!t||e.target===t)&&(e.preventDefault(),null==a||a({event:e.nativeEvent}),!0)}return!1}}];class qe{constructor(e,t,r){var s;void 0===r&&(r=function(e){const{EventTarget:t}=I(e);return e instanceof t?e:R(e)}(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:a}=e,{target:n}=a;this.props=e,this.events=t,this.document=R(n),this.documentListeners=new Le(this.document),this.listeners=new Le(r),this.windowListeners=new Le(I(n)),this.initialCoordinates=null!=(s=H(a))?s:ne,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:r}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(Ue.Resize,this.handleCancel),this.windowListeners.add(Ue.DragStart,Ge),this.windowListeners.add(Ue.VisibilityChange,this.handleCancel),this.windowListeners.add(Ue.ContextMenu,Ge),this.documentListeners.add(Ue.Keydown,this.handleKeydown),t){if(null!=r&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Ve(t))return this.timeoutId=setTimeout(this.handleStart,t.delay),void this.handlePending(t);if(Xe(t))return void this.handlePending(t)}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){const{active:r,onPending:s}=this.props;s(r,e,this.initialCoordinates,t)}handleStart(){const{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(Ue.Click,He,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Ue.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;const{activated:r,initialCoordinates:s,props:a}=this,{onMove:n,options:{activationConstraint:o}}=a;if(!s)return;const l=null!=(t=H(e))?t:ne,i=z(s,l);if(!r&&o){if(Xe(o)){if(null!=o.tolerance&&$e(i,o.tolerance))return this.handleCancel();if($e(i,o.distance))return this.handleStart()}return Ve(o)&&$e(i,o.tolerance)?this.handleCancel():void this.handlePending(o,i)}e.cancelable&&e.preventDefault(),n(l)}handleEnd(){const{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){const{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===Oe.Esc&&this.handleCancel()}removeTextSelection(){var e;null==(e=this.document.getSelection())||e.removeAllRanges()}}const Je={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Qe extends qe{constructor(e){const{event:t}=e,r=R(t.target);super(e,Je,r)}}Qe.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:s}=t;return!(!r.isPrimary||0!==r.button)&&(null==s||s({event:r}),!0)}}];const Ze={move:{name:"mousemove"},end:{name:"mouseup"}};var et,tt;(tt=et||(et={}))[tt.RightClick=2]="RightClick";(class extends qe{constructor(e){super(e,Ze,R(e.event.target))}}).activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:s}=t;return r.button!==et.RightClick&&(null==s||s({event:r}),!0)}}];const rt={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};var st,at,nt,ot;function lt(e){let{acceleration:t,activator:r=st.Pointer,canScroll:s,draggingRect:a,enabled:o,interval:l=5,order:i=nt.TreeOrder,pointerCoordinates:d,scrollableAncestors:c,scrollableAncestorRects:u,delta:m,threshold:b}=e;const h=function(e){let{delta:t,disabled:r}=e;const s=L(t);return A(e=>{if(r||!s||!e)return it;const a={x:Math.sign(t.x-s.x),y:Math.sign(t.y-s.y)};return{x:{[Ie.Backward]:e.x[Ie.Backward]||-1===a.x,[Ie.Forward]:e.x[Ie.Forward]||1===a.x},y:{[Ie.Backward]:e.y[Ie.Backward]||-1===a.y,[Ie.Forward]:e.y[Ie.Forward]||1===a.y}}},[r,t,s])}({delta:m,disabled:!o}),[x,f]=function(){const e=n.useRef(null);return[n.useCallback((t,r)=>{e.current=setInterval(t,r)},[]),n.useCallback(()=>{null!==e.current&&(clearInterval(e.current),e.current=null)},[])]}(),g=n.useRef({x:0,y:0}),p=n.useRef({x:0,y:0}),v=n.useMemo(()=>{switch(r){case st.Pointer:return d?{top:d.y,bottom:d.y,left:d.x,right:d.x}:null;case st.DraggableRect:return a}},[r,a,d]),y=n.useRef(null),w=n.useCallback(()=>{const e=y.current;if(!e)return;const t=g.current.x*p.current.x,r=g.current.y*p.current.y;e.scrollBy(t,r)},[]),j=n.useMemo(()=>i===nt.TreeOrder?[...c].reverse():c,[i,c]);n.useEffect(()=>{if(o&&c.length&&v){for(const e of j){if(!1===(null==s?void 0:s(e)))continue;const r=c.indexOf(e),a=u[r];if(!a)continue;const{direction:n,speed:o}=Te(e,a,v,t,b);for(const e of["x","y"])h[e][n[e]]||(o[e]=0,n[e]=0);if(o.x>0||o.y>0)return f(),y.current=e,x(w,l),g.current=o,void(p.current=n)}g.current={x:0,y:0},p.current={x:0,y:0},f()}else f()},[t,w,s,f,o,l,JSON.stringify(v),JSON.stringify(h),x,c,j,u,JSON.stringify(b)])}(class extends qe{constructor(e){super(e,rt)}static setup(){return window.addEventListener(rt.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(rt.move.name,e)};function e(){}}}).activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:s}=t;const{touches:a}=r;return!(a.length>1)&&(null==s||s({event:r}),!0)}}],(at=st||(st={}))[at.Pointer=0]="Pointer",at[at.DraggableRect=1]="DraggableRect",(ot=nt||(nt={}))[ot.TreeOrder=0]="TreeOrder",ot[ot.ReversedTreeOrder=1]="ReversedTreeOrder";const it={x:{[Ie.Backward]:!1,[Ie.Forward]:!1},y:{[Ie.Backward]:!1,[Ie.Forward]:!1}};var dt,ct,ut;(ct=dt||(dt={}))[ct.Always=0]="Always",ct[ct.BeforeDragging=1]="BeforeDragging",ct[ct.WhileDragging=2]="WhileDragging",(ut||(ut={})).Optimized="optimized";const mt=new Map;function bt(e,t){return A(r=>e?r||("function"==typeof t?t(e):e):null,[t,e])}function ht(e){let{callback:t,disabled:r}=e;const s=F(t),a=n.useMemo(()=>{if(r||"undefined"==typeof window||void 0===window.ResizeObserver)return;const{ResizeObserver:e}=window;return new e(s)},[r]);return n.useEffect(()=>()=>null==a?void 0:a.disconnect(),[a]),a}function xt(e){return new Be(ve(e),e)}function ft(e,t,r){void 0===t&&(t=xt);const[s,a]=n.useState(null);function o(){a(s=>{if(!e)return null;var a;if(!1===e.isConnected)return null!=(a=null!=s?s:r)?a:null;const n=t(e);return JSON.stringify(s)===JSON.stringify(n)?s:n})}const l=function(e){let{callback:t,disabled:r}=e;const s=F(t),a=n.useMemo(()=>{if(r||"undefined"==typeof window||void 0===window.MutationObserver)return;const{MutationObserver:e}=window;return new e(s)},[s,r]);return n.useEffect(()=>()=>null==a?void 0:a.disconnect(),[a]),a}({callback(t){if(e)for(const r of t){const{type:t,target:s}=r;if("childList"===t&&s instanceof HTMLElement&&s.contains(e)){o();break}}}}),i=ht({callback:o});return T(()=>{o(),e?(null==i||i.observe(e),null==l||l.observe(document.body,{childList:!0,subtree:!0})):(null==i||i.disconnect(),null==l||l.disconnect())},[e]),s}const gt=[];function pt(e,t){void 0===t&&(t=[]);const r=n.useRef(null);return n.useEffect(()=>{r.current=null},t),n.useEffect(()=>{const t=e!==ne;t&&!r.current&&(r.current=e),!t&&r.current&&(r.current=null)},[e]),r.current?z(e,r.current):ne}function vt(e){return n.useMemo(()=>e?function(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}(e):null,[e])}const yt=[];function wt(e){let{measure:t}=e;const[r,s]=n.useState(null),a=ht({callback:n.useCallback(e=>{for(const{target:r}of e)if(D(r)){s(e=>{const s=t(r);return e?{...e,width:s.width,height:s.height}:s});break}},[t])}),o=n.useCallback(e=>{const r=function(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return D(t)?t:e}(e);null==a||a.disconnect(),r&&(null==a||a.observe(r)),s(r?t(r):null)},[t,a]),[l,i]=B(o);return n.useMemo(()=>({nodeRef:l,rect:r,setRef:i}),[r,l,i])}const jt=[{sensor:Qe,options:{}},{sensor:Ke,options:{}}],Nt={current:{}},kt={draggable:{measure:ye},droppable:{measure:ye,strategy:dt.WhileDragging,frequency:ut.Optimized},dragOverlay:{measure:ve}};class Ct extends Map{get(e){var t;return null!=e&&null!=(t=super.get(e))?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,r;return null!=(t=null==(r=this.get(e))?void 0:r.node.current)?t:void 0}}const St={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Ct,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:se},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:kt,measureDroppableContainers:se,windowRect:null,measuringScheduled:!1},It={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:se,draggableNodes:new Map,over:null,measureDroppableContainers:se},Et=n.createContext(It),Dt=n.createContext(St);function Pt(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Ct}}}function Rt(e,t){switch(t.type){case te.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case te.DragMove:return null==e.draggable.active?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case te.DragEnd:case te.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case te.RegisterDroppable:{const{element:r}=t,{id:s}=r,a=new Ct(e.droppable.containers);return a.set(s,r),{...e,droppable:{...e.droppable,containers:a}}}case te.SetDroppableDisabled:{const{id:r,key:s,disabled:a}=t,n=e.droppable.containers.get(r);if(!n||s!==n.key)return e;const o=new Ct(e.droppable.containers);return o.set(r,{...n,disabled:a}),{...e,droppable:{...e.droppable,containers:o}}}case te.UnregisterDroppable:{const{id:r,key:s}=t,a=e.droppable.containers.get(r);if(!a||s!==a.key)return e;const n=new Ct(e.droppable.containers);return n.delete(r),{...e,droppable:{...e.droppable,containers:n}}}default:return e}}function Tt(e){let{disabled:t}=e;const{active:r,activatorEvent:s,draggableNodes:a}=n.useContext(Et),o=L(s),l=L(null==r?void 0:r.id);return n.useEffect(()=>{if(!t&&!s&&o&&null!=l){if(!G(o))return;if(document.activeElement===o.target)return;const e=a.get(l);if(!e)return;const{activatorNode:t,node:r}=e;if(!t.current&&!r.current)return;requestAnimationFrame(()=>{for(const e of[t.current,r.current]){if(!e)continue;const t=K(e);if(t){t.focus();break}}})}},[s,t,a,l,o]),null}const Ft=n.createContext({...ne,scaleX:1,scaleY:1});var Mt,At;(At=Mt||(Mt={}))[At.Uninitialized=0]="Uninitialized",At[At.Initializing=1]="Initializing",At[At.Initialized=2]="Initialized";const Bt=n.memo(function(e){var t,r,s,a;let{id:o,accessibility:d,autoScroll:c=!0,children:u,sensors:m=jt,collisionDetection:b=he,measuring:h,modifiers:x,...f}=e;const g=n.useReducer(Rt,void 0,Pt),[p,v]=g,[y,w]=function(){const[e]=n.useState(()=>new Set),t=n.useCallback(t=>(e.add(t),()=>e.delete(t)),[e]);return[n.useCallback(t=>{let{type:r,event:s}=t;e.forEach(e=>{var t;return null==(t=e[r])?void 0:t.call(e,s)})},[e]),t]}(),[j,N]=n.useState(Mt.Uninitialized),C=j===Mt.Initialized,{draggable:{active:S,nodes:E,translate:D},droppable:{containers:P}}=p,R=null!=S?E.get(S):null,F=n.useRef({initial:null,translated:null}),B=n.useMemo(()=>{var e;return null!=S?{id:S,data:null!=(e=null==R?void 0:R.data)?e:Nt,rect:F}:null},[S,R]),L=n.useRef(null),[$,_]=n.useState(null),[z,G]=n.useState(null),W=M(f,Object.values(f)),Y=U("DndDescribedBy",o),K=n.useMemo(()=>P.getEnabled(),[P]),X=(V=h,n.useMemo(()=>({draggable:{...kt.draggable,...null==V?void 0:V.draggable},droppable:{...kt.droppable,...null==V?void 0:V.droppable},dragOverlay:{...kt.dragOverlay,...null==V?void 0:V.dragOverlay}}),[null==V?void 0:V.draggable,null==V?void 0:V.droppable,null==V?void 0:V.dragOverlay]));var V;const{droppableRects:q,measureDroppableContainers:Q,measuringScheduled:Z}=function(e,t){let{dragging:r,dependencies:s,config:a}=t;const[o,l]=n.useState(null),{frequency:i,measure:d,strategy:c}=a,u=n.useRef(e),m=function(){switch(c){case dt.Always:return!1;case dt.BeforeDragging:return r;default:return!r}}(),b=M(m),h=n.useCallback(function(e){void 0===e&&(e=[]),b.current||l(t=>null===t?e:t.concat(e.filter(e=>!t.includes(e))))},[b]),x=n.useRef(null),f=A(t=>{if(m&&!r)return mt;if(!t||t===mt||u.current!==e||null!=o){const t=new Map;for(let r of e){if(!r)continue;if(o&&o.length>0&&!o.includes(r.id)&&r.rect.current){t.set(r.id,r.rect.current);continue}const e=r.node.current,s=e?new Be(d(e),e):null;r.rect.current=s,s&&t.set(r.id,s)}return t}return t},[e,o,r,m,d]);return n.useEffect(()=>{u.current=e},[e]),n.useEffect(()=>{m||h()},[r,m]),n.useEffect(()=>{o&&o.length>0&&l(null)},[JSON.stringify(o)]),n.useEffect(()=>{m||"number"!=typeof i||null!==x.current||(x.current=setTimeout(()=>{h(),x.current=null},i))},[i,m,h,...s]),{droppableRects:f,measureDroppableContainers:h,measuringScheduled:null!=o}}(K,{dragging:C,dependencies:[D.x,D.y],config:X.droppable}),re=function(e,t){const r=null!=t?e.get(t):void 0,s=r?r.node.current:null;return A(e=>{var r;return null==t?null:null!=(r=null!=s?s:e)?r:null},[s,t])}(E,S),se=n.useMemo(()=>z?H(z):null,[z]),ae=function(){const e=!1===(null==$?void 0:$.autoScrollEnabled),t="object"==typeof c?!1===c.enabled:!1===c,r=C&&!e&&!t;if("object"==typeof c)return{...c,enabled:r};return{enabled:r}}(),oe=function(e,t){return bt(e,t)}(re,X.draggable.measure);!function(e){let{activeNode:t,measure:r,initialRect:s,config:a=!0}=e;const o=n.useRef(!1),{x:l,y:i}="boolean"==typeof a?{x:a,y:a}:a;T(()=>{if(!l&&!i||!t)return void(o.current=!1);if(o.current||!s)return;const e=null==t?void 0:t.node.current;if(!e||!1===e.isConnected)return;const a=xe(r(e),s);if(l||(a.x=0),i||(a.y=0),o.current=!0,Math.abs(a.x)>0||Math.abs(a.y)>0){const t=je(e);t&&t.scrollBy({top:a.y,left:a.x})}},[t,l,i,s,r])}({activeNode:null!=S?E.get(S):null,config:ae.layoutShiftCompensation,initialRect:oe,measure:X.draggable.measure});const le=ft(re,X.draggable.measure,oe),ie=ft(re?re.parentElement:null),de=n.useRef({activatorEvent:null,active:null,activeNode:re,collisionRect:null,collisions:null,droppableRects:q,draggableNodes:E,draggingNode:null,draggingNodeRect:null,droppableContainers:P,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),ue=P.getNodeFor(null==(t=de.current.over)?void 0:t.id),me=wt({measure:X.dragOverlay.measure}),be=null!=(r=me.nodeRef.current)?r:re,fe=C?null!=(s=me.rect)?s:le:null,pe=Boolean(me.nodeRef.current&&me.rect),ye=xe(ke=pe?null:le,bt(ke));var ke;const Ce=vt(be?I(be):null),Ie=function(e){const t=n.useRef(e),r=A(r=>e?r&&r!==gt&&e&&t.current&&e.parentNode===t.current.parentNode?r:we(e):gt,[e]);return n.useEffect(()=>{t.current=e},[e]),r}(C?null!=ue?ue:re:null),Ee=function(e,t){void 0===t&&(t=ve);const[r]=e,s=vt(r?I(r):null),[a,o]=n.useState(yt);function l(){o(()=>e.length?e.map(e=>De(e)?s:new Be(t(e),e)):yt)}const i=ht({callback:l});return T(()=>{null==i||i.disconnect(),l(),e.forEach(e=>null==i?void 0:i.observe(e))},[e]),a}(Ie),Pe=function(e,t){let{transform:r,...s}=t;return null!=e&&e.length?e.reduce((e,t)=>t({transform:e,...s}),r):r}(x,{transform:{x:D.x-ye.x,y:D.y-ye.y,scaleX:1,scaleY:1},activatorEvent:z,active:B,activeNodeRect:le,containerNodeRect:ie,draggingNodeRect:fe,over:de.current.over,overlayNodeRect:me.rect,scrollableAncestors:Ie,scrollableAncestorRects:Ee,windowRect:Ce}),Re=se?O(se,D):null,Te=function(e){const[t,r]=n.useState(null),s=n.useRef(e),a=n.useCallback(e=>{const t=Ne(e.target);t&&r(e=>e?(e.set(t,Se(t)),new Map(e)):null)},[]);return n.useEffect(()=>{const t=s.current;if(e!==t){n(t);const o=e.map(e=>{const t=Ne(e);return t?(t.addEventListener("scroll",a,{passive:!0}),[t,Se(t)]):null}).filter(e=>null!=e);r(o.length?new Map(o):null),s.current=e}return()=>{n(e),n(t)};function n(e){e.forEach(e=>{const t=Ne(e);null==t||t.removeEventListener("scroll",a)})}},[a,e]),n.useMemo(()=>e.length?t?Array.from(t.values()).reduce((e,t)=>O(e,t),ne):Me(e):ne,[e,t])}(Ie),Fe=pt(Te),Ae=pt(Te,[le]),Le=O(Pe,Fe),$e=fe?ge(fe,Pe):null,Ue=B&&$e?b({active:B,collisionRect:$e,droppableRects:q,droppableContainers:K,pointerCoordinates:Re}):null,_e=ce(Ue,"id"),[Oe,ze]=n.useState(null),Ge=function(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}(pe?Pe:O(Pe,Ae),null!=(a=null==Oe?void 0:Oe.rect)?a:null,le),He=n.useRef(null),We=n.useCallback((e,t)=>{let{sensor:r,options:s}=t;if(null==L.current)return;const a=E.get(L.current);if(!a)return;const n=e.nativeEvent,o=new r({active:L.current,activeNode:a,event:n,options:s,context:de,onAbort(e){if(!E.get(e))return;const{onDragAbort:t}=W.current,r={id:e};null==t||t(r),y({type:"onDragAbort",event:r})},onPending(e,t,r,s){if(!E.get(e))return;const{onDragPending:a}=W.current,n={id:e,constraint:t,initialCoordinates:r,offset:s};null==a||a(n),y({type:"onDragPending",event:n})},onStart(e){const t=L.current;if(null==t)return;const r=E.get(t);if(!r)return;const{onDragStart:s}=W.current,a={activatorEvent:n,active:{id:t,data:r.data,rect:F}};i.unstable_batchedUpdates(()=>{null==s||s(a),N(Mt.Initializing),v({type:te.DragStart,initialCoordinates:e,active:t}),y({type:"onDragStart",event:a}),_(He.current),G(n)})},onMove(e){v({type:te.DragMove,coordinates:e})},onEnd:l(te.DragEnd),onCancel:l(te.DragCancel)});function l(e){return async function(){const{active:t,collisions:r,over:s,scrollAdjustedTranslate:a}=de.current;let o=null;if(t&&a){const{cancelDrop:l}=W.current;if(o={activatorEvent:n,active:t,collisions:r,delta:a,over:s},e===te.DragEnd&&"function"==typeof l){await Promise.resolve(l(o))&&(e=te.DragCancel)}}L.current=null,i.unstable_batchedUpdates(()=>{v({type:e}),N(Mt.Uninitialized),ze(null),_(null),G(null),He.current=null;const t=e===te.DragEnd?"onDragEnd":"onDragCancel";if(o){const e=W.current[t];null==e||e(o),y({type:t,event:o})}})}}He.current=o},[E]),Ye=function(e,t){return n.useMemo(()=>e.reduce((e,r)=>{const{sensor:s}=r;return[...e,...s.activators.map(e=>({eventName:e.eventName,handler:t(e.handler,r)}))]},[]),[e,t])}(m,n.useCallback((e,t)=>(r,s)=>{const a=r.nativeEvent,n=E.get(s);if(null!==L.current||!n||a.dndKit||a.defaultPrevented)return;const o={active:n};!0===e(r,t.options,o)&&(a.dndKit={capturedBy:t.sensor},L.current=s,We(r,t))},[E,We]));!function(e){n.useEffect(()=>{if(!k)return;const t=e.map(e=>{let{sensor:t}=e;return null==t.setup?void 0:t.setup()});return()=>{for(const e of t)null==e||e()}},e.map(e=>{let{sensor:t}=e;return t}))}(m),T(()=>{le&&j===Mt.Initializing&&N(Mt.Initialized)},[le,j]),n.useEffect(()=>{const{onDragMove:e}=W.current,{active:t,activatorEvent:r,collisions:s,over:a}=de.current;if(!t||!r)return;const n={active:t,activatorEvent:r,collisions:s,delta:{x:Le.x,y:Le.y},over:a};i.unstable_batchedUpdates(()=>{null==e||e(n),y({type:"onDragMove",event:n})})},[Le.x,Le.y]),n.useEffect(()=>{const{active:e,activatorEvent:t,collisions:r,droppableContainers:s,scrollAdjustedTranslate:a}=de.current;if(!e||null==L.current||!t||!a)return;const{onDragOver:n}=W.current,o=s.get(_e),l=o&&o.rect.current?{id:o.id,rect:o.rect.current,data:o.data,disabled:o.disabled}:null,d={active:e,activatorEvent:t,collisions:r,delta:{x:a.x,y:a.y},over:l};i.unstable_batchedUpdates(()=>{ze(l),null==n||n(d),y({type:"onDragOver",event:d})})},[_e]),T(()=>{de.current={activatorEvent:z,active:B,activeNode:re,collisionRect:$e,collisions:Ue,droppableRects:q,draggableNodes:E,draggingNode:be,draggingNodeRect:fe,droppableContainers:P,over:Oe,scrollableAncestors:Ie,scrollAdjustedTranslate:Le},F.current={initial:fe,translated:$e}},[B,re,Ue,$e,E,be,fe,q,P,Oe,Ie,Le]),lt({...ae,delta:D,draggingRect:$e,pointerCoordinates:Re,scrollableAncestors:Ie,scrollableAncestorRects:Ee});const Ke=n.useMemo(()=>({active:B,activeNode:re,activeNodeRect:le,activatorEvent:z,collisions:Ue,containerNodeRect:ie,dragOverlay:me,draggableNodes:E,droppableContainers:P,droppableRects:q,over:Oe,measureDroppableContainers:Q,scrollableAncestors:Ie,scrollableAncestorRects:Ee,measuringConfiguration:X,measuringScheduled:Z,windowRect:Ce}),[B,re,le,z,Ue,ie,me,E,P,q,Oe,Q,Ie,Ee,X,Z,Ce]),Xe=n.useMemo(()=>({activatorEvent:z,activators:Ye,active:B,activeNodeRect:le,ariaDescribedById:{draggable:Y},dispatch:v,draggableNodes:E,over:Oe,measureDroppableContainers:Q}),[z,Ye,B,le,v,Y,E,Oe,Q]);return l.createElement(J.Provider,{value:w},l.createElement(Et.Provider,{value:Xe},l.createElement(Dt.Provider,{value:Ke},l.createElement(Ft.Provider,{value:Ge},u)),l.createElement(Tt,{disabled:!1===(null==d?void 0:d.restoreFocus)})),l.createElement(ee,{...d,hiddenTextDescribedById:Y}))}),Lt=n.createContext(null),$t="button";function Ut(e){let{id:t,data:r,disabled:s=!1,attributes:a}=e;const o=U("Draggable"),{activators:l,activatorEvent:i,active:d,activeNodeRect:c,ariaDescribedById:u,draggableNodes:m,over:b}=n.useContext(Et),{role:h=$t,roleDescription:x="draggable",tabIndex:f=0}=null!=a?a:{},g=(null==d?void 0:d.id)===t,p=n.useContext(g?Ft:Lt),[v,y]=B(),[w,j]=B(),N=function(e,t){return n.useMemo(()=>e.reduce((e,r)=>{let{eventName:s,handler:a}=r;return e[s]=e=>{a(e,t)},e},{}),[e,t])}(l,t),k=M(r);T(()=>(m.set(t,{id:t,key:o,node:v,activatorNode:w,data:k}),()=>{const e=m.get(t);e&&e.key===o&&m.delete(t)}),[m,t]);return{active:d,activatorEvent:i,activeNodeRect:c,attributes:n.useMemo(()=>({role:h,tabIndex:f,"aria-disabled":s,"aria-pressed":!(!g||h!==$t)||void 0,"aria-roledescription":x,"aria-describedby":u.draggable}),[s,h,f,g,x,u.draggable]),isDragging:g,listeners:s?void 0:N,node:v,over:b,setNodeRef:y,setActivatorNodeRef:j,transform:p}}const _t={timeout:25};function Ot(e,t,r){const s=e.slice();return s.splice(r<0?s.length+r:r,0,s.splice(t,1)[0]),s}function zt(e,t){return e.reduce((e,r,s)=>{const a=t.get(r);return a&&(e[s]=a),e},Array(e.length))}function Gt(e){return null!==e&&e>=0}const Ht=e=>{let{rects:t,activeIndex:r,overIndex:s,index:a}=e;const n=Ot(t,s,r),o=t[a],l=n[a];return l&&o?{x:l.left-o.left,y:l.top-o.top,scaleX:l.width/o.width,scaleY:l.height/o.height}:null},Wt={scaleX:1,scaleY:1},Yt=e=>{var t;let{activeIndex:r,activeNodeRect:s,index:a,rects:n,overIndex:o}=e;const l=null!=(t=n[r])?t:s;if(!l)return null;if(a===r){const e=n[o];return e?{x:0,y:r<o?e.top+e.height-(l.top+l.height):e.top-l.top,...Wt}:null}const i=function(e,t,r){const s=e[t],a=e[t-1],n=e[t+1];if(!s)return 0;if(r<t)return a?s.top-(a.top+a.height):n?n.top-(s.top+s.height):0;return n?n.top-(s.top+s.height):a?s.top-(a.top+a.height):0}(n,a,r);return a>r&&a<=o?{x:0,y:-l.height-i,...Wt}:a<r&&a>=o?{x:0,y:l.height+i,...Wt}:{x:0,y:0,...Wt}};const Kt="Sortable",Xt=l.createContext({activeIndex:-1,containerId:Kt,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Ht,disabled:{draggable:!1,droppable:!1}});function Vt(e){let{children:t,id:r,items:s,strategy:a=Ht,disabled:o=!1}=e;const{active:i,dragOverlay:d,droppableRects:c,over:u,measureDroppableContainers:m}=n.useContext(Dt),b=U(Kt,r),h=Boolean(null!==d.rect),x=n.useMemo(()=>s.map(e=>"object"==typeof e&&"id"in e?e.id:e),[s]),f=null!=i,g=i?x.indexOf(i.id):-1,p=u?x.indexOf(u.id):-1,v=n.useRef(x),y=!function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}(x,v.current),w=-1!==p&&-1===g||y,j=function(e){return"boolean"==typeof e?{draggable:e,droppable:e}:e}(o);T(()=>{y&&f&&m(x)},[y,x,f,m]),n.useEffect(()=>{v.current=x},[x]);const N=n.useMemo(()=>({activeIndex:g,containerId:b,disabled:j,disableTransforms:w,items:x,overIndex:p,useDragOverlay:h,sortedRects:zt(x,c),strategy:a}),[g,b,j.draggable,j.droppable,w,x,p,c,h,a]);return l.createElement(Xt.Provider,{value:N},t)}const qt=e=>{let{id:t,items:r,activeIndex:s,overIndex:a}=e;return Ot(r,s,a).indexOf(t)},Jt=e=>{let{containerId:t,isSorting:r,wasDragging:s,index:a,items:n,newIndex:o,previousItems:l,previousContainerId:i,transition:d}=e;return!(!d||!s)&&((l===n||a!==o)&&(!!r||o!==a&&t===i))},Qt={duration:200,easing:"ease"},Zt="transform",er=W.Transition.toString({property:Zt,duration:0,easing:"linear"}),tr={roleDescription:"sortable"};function rr(e){let{animateLayoutChanges:t=Jt,attributes:r,disabled:s,data:a,getNewIndex:o=qt,id:l,strategy:i,resizeObserverConfig:d,transition:c=Qt}=e;const{items:u,containerId:m,activeIndex:b,disabled:h,disableTransforms:x,sortedRects:f,overIndex:g,useDragOverlay:p,strategy:v}=n.useContext(Xt),y=function(e,t){var r,s;if("boolean"==typeof e)return{draggable:e,droppable:!1};return{draggable:null!=(r=null==e?void 0:e.draggable)?r:t.draggable,droppable:null!=(s=null==e?void 0:e.droppable)?s:t.droppable}}(s,h),w=u.indexOf(l),j=n.useMemo(()=>({sortable:{containerId:m,index:w,items:u},...a}),[m,a,w,u]),N=n.useMemo(()=>u.slice(u.indexOf(l)),[u,l]),{rect:k,node:C,isOver:S,setNodeRef:I}=function(e){let{data:t,disabled:r=!1,id:s,resizeObserverConfig:a}=e;const o=U("Droppable"),{active:l,dispatch:i,over:d,measureDroppableContainers:c}=n.useContext(Et),u=n.useRef({disabled:r}),m=n.useRef(!1),b=n.useRef(null),h=n.useRef(null),{disabled:x,updateMeasurementsFor:f,timeout:g}={..._t,...a},p=M(null!=f?f:s),v=ht({callback:n.useCallback(()=>{m.current?(null!=h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{c(Array.isArray(p.current)?p.current:[p.current]),h.current=null},g)):m.current=!0},[g]),disabled:x||!l}),y=n.useCallback((e,t)=>{v&&(t&&(v.unobserve(t),m.current=!1),e&&v.observe(e))},[v]),[w,j]=B(y),N=M(t);return n.useEffect(()=>{v&&w.current&&(v.disconnect(),m.current=!1,v.observe(w.current))},[w,v]),n.useEffect(()=>(i({type:te.RegisterDroppable,element:{id:s,key:o,disabled:r,node:w,rect:b,data:N}}),()=>i({type:te.UnregisterDroppable,key:o,id:s})),[s]),n.useEffect(()=>{r!==u.current.disabled&&(i({type:te.SetDroppableDisabled,id:s,key:o,disabled:r}),u.current.disabled=r)},[s,o,r,i]),{active:l,rect:b,isOver:(null==d?void 0:d.id)===s,node:w,over:d,setNodeRef:j}}({id:l,data:j,disabled:y.droppable,resizeObserverConfig:{updateMeasurementsFor:N,...d}}),{active:E,activatorEvent:D,activeNodeRect:P,attributes:R,setNodeRef:F,listeners:A,isDragging:L,over:$,setActivatorNodeRef:_,transform:O}=Ut({id:l,data:j,attributes:{...tr,...r},disabled:y.draggable}),z=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.useMemo(()=>e=>{t.forEach(t=>t(e))},t)}(I,F),H=Boolean(E),Y=H&&!x&&Gt(b)&&Gt(g),K=!p&&L,X=K&&Y?O:null,V=Y?null!=X?X:(null!=i?i:v)({rects:f,activeNodeRect:P,activeIndex:b,overIndex:g,index:w}):null,q=Gt(b)&&Gt(g)?o({id:l,items:u,activeIndex:b,overIndex:g}):w,J=null==E?void 0:E.id,Q=n.useRef({activeId:J,items:u,newIndex:q,containerId:m}),Z=u!==Q.current.items,ee=t({active:E,containerId:m,isDragging:L,isSorting:H,id:l,index:w,items:u,newIndex:Q.current.newIndex,previousItems:Q.current.items,previousContainerId:Q.current.containerId,transition:c,wasDragging:null!=Q.current.activeId}),re=function(e){let{disabled:t,index:r,node:s,rect:a}=e;const[o,l]=n.useState(null),i=n.useRef(r);return T(()=>{if(!t&&r!==i.current&&s.current){const e=a.current;if(e){const t=ve(s.current,{ignoreTransform:!0}),r={x:e.left-t.left,y:e.top-t.top,scaleX:e.width/t.width,scaleY:e.height/t.height};(r.x||r.y)&&l(r)}}r!==i.current&&(i.current=r)},[t,r,s,a]),n.useEffect(()=>{o&&l(null)},[o]),o}({disabled:!ee,index:w,node:C,rect:k});return n.useEffect(()=>{H&&Q.current.newIndex!==q&&(Q.current.newIndex=q),m!==Q.current.containerId&&(Q.current.containerId=m),u!==Q.current.items&&(Q.current.items=u)},[H,q,m,u]),n.useEffect(()=>{if(J===Q.current.activeId)return;if(J&&!Q.current.activeId)return void(Q.current.activeId=J);const e=setTimeout(()=>{Q.current.activeId=J},50);return()=>clearTimeout(e)},[J]),{active:E,activeIndex:b,attributes:R,data:j,rect:k,index:w,newIndex:q,items:u,isOver:S,isSorting:H,isDragging:L,listeners:A,node:C,overIndex:g,over:$,setNodeRef:z,setActivatorNodeRef:_,setDroppableNodeRef:I,setDraggableNodeRef:F,transform:null!=re?re:V,transition:function(){if(re||Z&&Q.current.newIndex===w)return er;if(K&&!G(D)||!c)return;if(H||ee)return W.Transition.toString({...c,property:Zt});return}()}}function sr(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&"object"==typeof t.sortable&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const ar=[Oe.Down,Oe.Right,Oe.Up,Oe.Left],nr=(e,t)=>{let{context:{active:r,collisionRect:s,droppableRects:a,droppableContainers:n,over:o,scrollableAncestors:l}}=t;if(ar.includes(e.code)){if(e.preventDefault(),!r||!s)return;const t=[];n.getEnabled().forEach(r=>{if(!r||null!=r&&r.disabled)return;const n=a.get(r.id);if(n)switch(e.code){case Oe.Down:s.top<n.top&&t.push(r);break;case Oe.Up:s.top>n.top&&t.push(r);break;case Oe.Left:s.left>n.left&&t.push(r);break;case Oe.Right:s.left<n.left&&t.push(r)}});const i=(e=>{let{collisionRect:t,droppableRects:r,droppableContainers:s}=e;const a=de(t),n=[];for(const o of s){const{id:e}=o,t=r.get(e);if(t){const r=de(t),s=a.reduce((e,t,s)=>e+oe(r[s],t),0),l=Number((s/4).toFixed(4));n.push({id:e,data:{droppableContainer:o,value:l}})}}return n.sort(le)})({collisionRect:s,droppableRects:a,droppableContainers:t});let d=ce(i,"id");if(d===(null==o?void 0:o.id)&&i.length>1&&(d=i[1].id),null!=d){const e=n.get(r.id),t=n.get(d),o=t?a.get(t.id):null,i=null==t?void 0:t.node.current;if(i&&o&&e&&t){const r=we(i).some((e,t)=>l[t]!==e),a=or(e,t),n=function(e,t){if(!sr(e)||!sr(t))return!1;if(!or(e,t))return!1;return e.data.current.sortable.index<t.data.current.sortable.index}(e,t),d=r||!a?{x:0,y:0}:{x:n?s.width-o.width:0,y:n?s.height-o.height:0},c={x:o.left,y:o.top};return d.x&&d.y?c:z(c,d)}}}};function or(e,t){return!(!sr(e)||!sr(t))&&e.data.current.sortable.containerId===t.data.current.sortable.containerId}function lr({onClose:r}){const[s,l]=a("template",{templates:[]}),i=(null==s?void 0:s.templates)||[],[d,c]=n.useState(null),[u,m]=n.useState(""),[b,h]=n.useState(""),[x,f]=n.useState(""),[g,p]=n.useState(!1),[v,y]=n.useState(""),[j,N]=n.useState(""),[k,C]=n.useState(""),S=async()=>{if(d){const r=i.map(e=>e.id===d?{...e,title:u.trim(),keywords:b.trim(),text:x.trim()}:e);await e.set("template",{templates:r}),l({templates:r}),t.success("Template updated successfully",!0),c(null),m(""),h(""),f("")}},I=()=>{c(null),m(""),h(""),f("")},E=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.useMemo(()=>[...t].filter(e=>null!=e),[...t])}(ae(Qe),ae(Ke,{coordinateGetter:nr})),D=({template:r,index:s})=>{const{attributes:a,listeners:n,setNodeRef:g,transform:p,transition:v,isDragging:y}=rr({id:r.id,disabled:d===r.id}),j={transform:W.Transform.toString(p),transition:v,opacity:y?.5:1};return o.jsx("div",{ref:g,style:j,className:"p-3 border rounded-lg bg-dark-bg transition-all "+(y?"border-blue-500":"border-dark-border hover:border-gray-500"),children:d===r.id?o.jsxs("div",{children:[o.jsxs("div",{className:"mb-3",children:[o.jsx("label",{className:"block text-xs font-semibold mb-1 text-white",children:"Title"}),o.jsx("input",{type:"text",value:u,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 border border-dark-border rounded-md text-sm bg-dark-card text-white focus:outline-none focus:border-blue-500 focus:bg-dark-border transition-all",autoFocus:!0})]}),o.jsxs("div",{className:"mb-3",children:[o.jsx("label",{className:"block text-xs font-semibold mb-1 text-white",children:"Keywords"}),o.jsx(w,{value:b,onChange:e=>h(e),placeholder:"Add keywords (comma-separated or press Enter)",className:"w-full"})]}),o.jsxs("div",{className:"mb-3",children:[o.jsx("label",{className:"block text-xs font-semibold mb-1 text-white",children:"Template Text"}),o.jsx("textarea",{value:x,onChange:e=>f(e.target.value),rows:"4",className:"w-full px-3 py-2 border border-dark-border rounded-md text-sm bg-dark-card text-white focus:outline-none focus:border-blue-500 focus:bg-dark-border transition-all resize-y"})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:S,disabled:!u.trim()||!x.trim(),className:"flex-1 px-3 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm font-semibold",children:"Save"}),o.jsx("button",{onClick:I,className:"flex-1 px-3 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold",children:"Cancel"})]})]}):o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{...a,...n,className:"flex-shrink-0 pt-1 cursor-grab active:cursor-grabbing text-gray-500 hover:text-blue-400 transition-colors select-none",children:o.jsx("i",{className:"fas fa-grip-vertical text-lg"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"mb-2",children:[o.jsx("h4",{className:"text-sm font-semibold text-white mb-2",children:r.title||"Untitled Template"}),r.keywords&&(()=>{const e=r.keywords.split(",").filter(e=>e.trim()),t=e.slice(0,5),s=e.length>5;return o.jsx("div",{className:"mb-2 overflow-hidden",children:o.jsxs("div",{className:"flex flex-wrap gap-1",children:[t.map((e,t)=>o.jsx("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-dark-card border border-dark-border text-white text-xs font-medium rounded",children:e.trim()},t)),s&&o.jsx("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-gray-400 text-xs font-medium",children:"..."})]})})})()]}),o.jsx("p",{className:"text-sm text-white whitespace-pre-wrap break-words line-clamp-3",children:r.text})]}),o.jsxs("div",{className:"flex-shrink-0 flex items-center gap-2",children:[o.jsx("button",{onClick:()=>(e=>{c(e.id),m(e.title||""),h(e.keywords||""),f(e.text||"")})(r),className:"p-2 text-blue-400 hover:bg-dark-border rounded transition-colors",title:"Edit",children:o.jsx("i",{className:"fas fa-edit"})}),o.jsx("button",{onClick:()=>(async r=>{if(confirm("Are you sure you want to delete this template?")){const s=i.filter(e=>e.id!==r);await e.set("template",{templates:s}),l({templates:s}),t.success("Template deleted successfully",!0)}})(r.id),className:"p-2 text-red-400 hover:bg-dark-border rounded transition-colors",title:"Delete",children:o.jsx("i",{className:"fas fa-trash-alt"})})]})]})})};return o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black bg-opacity-50",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:o.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg shadow-xl w-[700px] min-h-[600px] max-h-[80vh] flex flex-col overflow-hidden",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-2.5 border-b border-dark-border cursor-move bg-dark-bg flex-shrink-0",children:[o.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[o.jsx("i",{className:"fas fa-file-alt text-gray-400"}),"Templates"]}),o.jsx("button",{onClick:r,className:"text-white hover:text-gray-300 transition-colors",children:o.jsx("i",{className:"fas fa-times text-xl"})})]}),o.jsxs("div",{className:"p-4 overflow-y-auto bg-dark-card flex-1 min-h-0 template-modal-scroll",style:{scrollbarWidth:"none",maxHeight:"calc(80vh - 60px)"},children:[o.jsx("style",{children:"\n            .template-modal-scroll::-webkit-scrollbar {\n              display: none;\n            }\n            .template-modal-scroll {\n              -ms-overflow-style: none;\n            }\n          "}),!g&&o.jsxs("button",{onClick:()=>p(!0),className:"w-full mb-4 px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors flex items-center justify-center gap-2 text-sm font-semibold",children:[o.jsx("i",{className:"fas fa-plus"}),"Add New Template"]}),g&&o.jsxs("div",{className:"mb-4 p-3 border border-blue-500 rounded-lg bg-dark-bg",children:[o.jsxs("div",{className:"mb-3",children:[o.jsx("label",{className:"block text-xs font-semibold mb-1 text-white",children:"Title"}),o.jsx("input",{type:"text",value:v,onChange:e=>y(e.target.value),placeholder:"Enter template title",className:"w-full px-3 py-2 border border-dark-border rounded-md text-sm bg-dark-card text-white focus:outline-none focus:border-blue-500 focus:bg-dark-border transition-all",autoFocus:!0})]}),o.jsxs("div",{className:"mb-3",children:[o.jsx("label",{className:"block text-xs font-semibold mb-1 text-white",children:"Keywords"}),o.jsx(w,{value:j,onChange:e=>N(e),placeholder:"Add keywords (comma-separated or press Enter)",className:"w-full"})]}),o.jsxs("div",{className:"mb-3",children:[o.jsx("label",{className:"block text-xs font-semibold mb-1 text-white",children:"Template Text"}),o.jsx("textarea",{value:k,onChange:e=>C(e.target.value),placeholder:"Enter template text",rows:"4",className:"w-full px-3 py-2 border border-dark-border rounded-md text-sm bg-dark-card text-white focus:outline-none focus:border-blue-500 focus:bg-dark-border transition-all resize-y"})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:async()=>{if(v.trim()&&k.trim()){const r={id:Date.now().toString(),title:v.trim(),keywords:j.trim(),text:k.trim()},s=[...i,r];await e.set("template",{templates:s}),l({templates:s}),t.success("Template added successfully",!0),y(""),N(""),C(""),p(!1)}},disabled:!v.trim()||!k.trim(),className:"flex-1 px-3 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm font-semibold",children:"Save"}),o.jsx("button",{onClick:()=>{p(!1),y(""),N(""),C("")},className:"flex-1 px-3 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors text-sm font-semibold",children:"Cancel"})]})]}),o.jsx(Bt,{sensors:E,collisionDetection:me,onDragEnd:async r=>{const{active:s,over:a}=r;if(a&&s.id!==a.id){const r=i.findIndex(e=>e.id===s.id),n=i.findIndex(e=>e.id===a.id),o=Ot(i,r,n);await e.set("template",{templates:o}),l({templates:o}),t.success("Templates reordered successfully",!0)}},children:o.jsx(Vt,{items:i.map(e=>e.id),strategy:Yt,children:o.jsx("div",{className:"space-y-2",children:0===i.length?o.jsxs("div",{className:"text-center py-8 text-gray-400",children:[o.jsx("i",{className:"fas fa-file-alt text-4xl mb-3"}),o.jsx("p",{children:"No templates yet. Add your first template above."})]}):i.map((e,t)=>o.jsx(D,{template:e,index:t},e.id))})})})]})]})})}function ir({onClose:r}){const[l]=a("auth",{}),[i]=a("bidding",{}),d=null==l?void 0:l.user,c=null==l?void 0:l.profile,u=(null==i?void 0:i.status)||s.STOPPED,[b,h]=n.useState("monthly"),[x,f]=n.useState(!1),[g,p]=n.useState(!1),v=async s=>{var a;try{f(!0);const n=null==(a=null==l?void 0:l.session)?void 0:a.refresh_token;if(!n)return t.error("No refresh token available"),alert("Authentication error: Please log in again."),void f(!1);t.log("Refreshing token before opening subscribe page...");const o=await m.refreshToken(n);if(!o.success)return t.error(`Failed to refresh token: ${o.error}`),alert(`Authentication error: ${o.error||"Failed to refresh token. Please log in again."}`),void f(!1);if(o.session&&o.user){const r={...l,session:o.session,user:o.user,profile:o.profile||l.profile};await e.set("auth",r),t.log("Token refreshed successfully")}f(!1);const i=chrome.runtime.getURL(`subscribe.html?plan=${s}&billing=${b}`);chrome.runtime.sendMessage({action:"openTab",url:i}).catch(e=>{t.error(`Failed to open subscription page: ${e.message}`,!0),alert(`Failed to open subscription page: ${e.message}`)}),r()}catch(n){f(!1);const e=(null==n?void 0:n.message)||(null==n?void 0:n.toString())||"Unknown error";t.error(`Error in handleSubscribe: ${e}`,!0),alert(`Failed to open subscription page: ${e}`)}},y=(null==d?void 0:d.email)||"N/A",w=(null==d?void 0:d.id)||"N/A",j=(null==d?void 0:d.created_at)?new Date(d.created_at).toLocaleDateString():"N/A",N=(null==c?void 0:c.membership)||"basic",k=null==c?void 0:c.membership_expires_at,C=k?(e=>{if(!e)return null;try{return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return null}})(k):null,S=("premium"===N||"ultra"===N)&&(!k||new Date(k)<new Date),I={premium:{monthly:4.99,"3month":13.47,"6month":23.95,annual:41.92},ultra:{monthly:9.99,"3month":26.97,"6month":47.95,annual:83.92}},E={premium:[{icon:"fa-robot",text:"Custom AI Bid Generation"},{icon:"fa-paper-plane",text:"Telegram Support"},{icon:"fa-comments",text:"Chatbot: 1 bot"},{icon:"fa-chart-line",text:"Daily Limit: 20"}],ultra:[{icon:"fa-robot",text:"Custom AI Bid Generation (Customizable)"},{icon:"fa-paper-plane",text:"Telegram Support"},{icon:"fa-comments",text:"Chatbot: No limit"},{icon:"fa-infinity",text:"Daily Limit: Unlimited"}]};return o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black bg-opacity-50",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:o.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg shadow-xl w-[700px] max-h-[90vh] flex flex-col overflow-hidden",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-dark-border cursor-move bg-dark-bg",children:[o.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[o.jsx("i",{className:"fas fa-user-circle text-blue-400"}),"Account"]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:async()=>{var r;try{p(!0);const s=null==(r=null==l?void 0:l.session)?void 0:r.refresh_token;if(!s)return t.error("No refresh token available"),alert("Authentication error: Please log in again."),void p(!1);t.log("Refreshing token...");const a=await m.refreshToken(s);if(!a.success)return t.error(`Failed to refresh token: ${a.error}`),alert(`Authentication error: ${a.error||"Failed to refresh token. Please log in again."}`),void p(!1);if(a.session&&a.user){const r={...l,session:a.session,user:a.user,profile:a.profile||l.profile};await e.set("auth",r),t.success("Token refreshed successfully. User data updated.",!0)}p(!1)}catch(s){p(!1);const e=(null==s?void 0:s.message)||(null==s?void 0:s.toString())||"Unknown error";t.error(`Error refreshing token: ${e}`,!0),alert(`Failed to refresh token: ${e}`)}},disabled:g,className:"text-white hover:text-blue-400 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Refresh token and update user data",children:o.jsx("i",{className:"fas fa-sync-alt text-lg "+(g?"fa-spin":"")})}),o.jsx("button",{onClick:r,className:"text-white hover:text-gray-300 transition-colors",children:o.jsx("i",{className:"fas fa-times text-xl"})})]})]}),o.jsxs("div",{className:"p-4 overflow-y-auto bg-dark-card scrollbar-hide",children:[o.jsxs("div",{className:"mb-4",children:[o.jsxs("h4",{className:"text-sm font-semibold text-white mb-3 flex items-center gap-2",children:[o.jsx("i",{className:"fas fa-info-circle text-blue-400"}),"Account Information"]}),o.jsxs("div",{className:"bg-dark-bg border border-dark-border rounded-lg p-3 space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-xs text-gray-400",children:"Email:"}),o.jsx("span",{className:"text-xs text-white font-medium",children:y})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-xs text-gray-400",children:"User ID:"}),o.jsx("span",{className:"text-xs text-white font-mono",children:w})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-xs text-gray-400",children:"Account Created:"}),o.jsx("span",{className:"text-xs text-white",children:j})]}),o.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-dark-border",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-xs text-gray-400",children:"Membership:"}),("premium"===N||"ultra"===N)&&C&&o.jsxs("span",{className:"text-xs px-2 py-1 rounded "+(S?"bg-red-500/20 text-red-400 border border-red-500/50":"bg-yellow-500/20 text-yellow-400 border border-yellow-500/50"),children:[o.jsx("i",{className:"fas fa-calendar-alt mr-1"}),S?"Expired":`Expires: ${C}`]})]}),o.jsx("span",{className:`text-xs font-semibold px-2 py-1 rounded ${(e=>{switch(e){case"premium":return"bg-gradient-to-r from-purple-500 to-pink-500 text-white";case"ultra":return"bg-gradient-to-r from-yellow-400 via-orange-500 to-red-500 text-white";default:return"bg-gray-600 text-white"}})(N)}`,children:N.toUpperCase()})]})]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("h4",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[o.jsx("i",{className:"fas fa-credit-card text-green-400"}),"Subscribe for Membership"]}),o.jsxs("select",{value:b,onChange:e=>h(e.target.value),className:"w-auto min-w-[200px] px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-sm text-white focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500",children:[o.jsx("option",{value:"monthly",children:"Monthly"}),o.jsx("option",{value:"3month",children:"Quarterly (3 Months) - 10% OFF"}),o.jsx("option",{value:"6month",children:"Semi-Annual (6 Months) - 20% OFF"}),o.jsx("option",{value:"annual",children:"Annual - 30% OFF"})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"bg-dark-bg border-2 border-purple-500 rounded-lg p-4 relative overflow-hidden",children:[o.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-purple-500 opacity-10 rounded-full -mr-10 -mt-10"}),o.jsxs("div",{className:"relative",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[o.jsx("i",{className:"fas fa-star text-purple-400 text-xl"}),o.jsx("h5",{className:"text-base font-bold text-white",children:"Premium"})]}),o.jsx("div",{className:"mb-4",children:o.jsxs("div",{className:"flex items-baseline gap-1 justify-between",children:[o.jsxs("div",{className:"flex items-baseline gap-1",children:[o.jsxs("span",{className:"text-2xl font-bold text-white",children:["$",I.premium[b]]}),o.jsxs("span",{className:"text-xs text-gray-400",children:["/","monthly"===b?"mo":"3month"===b?"3mo":"6month"===b?"6mo":"yr"]})]}),"monthly"!==b&&o.jsxs("div",{className:"text-xs text-green-400",children:["3month"===b&&`Save ${(3*I.premium.monthly-I.premium["3month"]).toFixed(2)}`,"6month"===b&&`Save ${(6*I.premium.monthly-I.premium["6month"]).toFixed(2)}`,"annual"===b&&`Save ${(12*I.premium.monthly-I.premium.annual).toFixed(2)}/year`]})]})}),o.jsx("ul",{className:"space-y-2 mb-4",children:E.premium.map((e,t)=>o.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-300",children:[o.jsx("i",{className:`fas ${e.icon} text-purple-400`}),o.jsx("span",{children:e.text})]},t))}),o.jsx("button",{onClick:()=>v("premium"),disabled:("premium"===N||"ultra"===N)&&!S||x,className:"w-full py-2 px-4 rounded-md text-sm font-semibold transition-colors "+(("premium"===N||"ultra"===N)&&!S||x?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-gradient-to-r from-purple-500 to-pink-500 text-white hover:from-purple-600 hover:to-pink-600"),children:x?"Loading...":"premium"!==N&&"ultra"!==N||S?"Subscribe":"Current Plan"})]})]}),o.jsxs("div",{className:"bg-dark-bg border-2 border-yellow-500 rounded-lg p-4 relative overflow-hidden",children:[o.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-yellow-500 opacity-10 rounded-full -mr-10 -mt-10"}),o.jsx("div",{className:"absolute top-2 right-2 bg-yellow-500 text-black text-[10px] font-bold px-2 py-0.5 rounded-full",children:"BEST"}),o.jsxs("div",{className:"relative",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[o.jsx("i",{className:"fas fa-crown text-yellow-400 text-xl"}),o.jsx("h5",{className:"text-base font-bold text-white",children:"Ultra"})]}),o.jsx("div",{className:"mb-4",children:o.jsxs("div",{className:"flex items-baseline gap-1 justify-between",children:[o.jsxs("div",{className:"flex items-baseline gap-1",children:[o.jsxs("span",{className:"text-2xl font-bold text-white",children:["$",I.ultra[b]]}),o.jsxs("span",{className:"text-xs text-gray-400",children:["/","monthly"===b?"mo":"3month"===b?"3mo":"6month"===b?"6mo":"yr"]})]}),"monthly"!==b&&o.jsxs("div",{className:"text-xs text-green-400",children:["3month"===b&&`Save ${(3*I.ultra.monthly-I.ultra["3month"]).toFixed(2)}`,"6month"===b&&`Save ${(6*I.ultra.monthly-I.ultra["6month"]).toFixed(2)}`,"annual"===b&&`Save ${(12*I.ultra.monthly-I.ultra.annual).toFixed(2)}/year`]})]})}),o.jsx("ul",{className:"space-y-2 mb-4",children:E.ultra.map((e,t)=>o.jsxs("li",{className:"flex items-center gap-2 text-xs text-gray-300",children:[o.jsx("i",{className:`fas ${e.icon} text-yellow-400`}),o.jsx("span",{children:e.text})]},t))}),o.jsx("button",{onClick:()=>v("ultra"),disabled:"ultra"===N&&!S||x,className:"w-full py-2 px-4 rounded-md text-sm font-semibold transition-colors "+("ultra"===N&&!S||x?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-gradient-to-r from-yellow-400 via-orange-500 to-red-500 text-white hover:from-yellow-500 hover:via-orange-600 hover:to-red-600"),children:x?"Loading...":"ultra"!==N||S?"Subscribe":"Current Plan"})]})]})]})]}),o.jsx("div",{className:"border-t border-dark-border pt-4",children:o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("button",{onClick:async()=>{if(confirm("Are you sure you want to delete your account? This action cannot be undone.")&&confirm("This will permanently delete your account and all associated data. Are you absolutely sure?"))try{if(u===s.RUNNING||"Running"===u)try{const t=await e.get("bidding")||{};await e.set("bidding",{...t,status:s.STOPPED,isRunning:!1}),chrome.runtime.sendMessage({action:"stopBot"}).catch(()=>{})}catch(a){}if(!d)throw new Error("User not found. Please try logging out and logging back in.");if(!d.id)throw new Error("User ID not found. Please try logging out and logging back in.");await m.deleteAccount(d.id),await e.set("logs",{logs:[],unreadCount:0}),t.success("Account deleted successfully",!0),await e.remove("auth"),await e.remove("profile"),r(),window.location.reload()}catch(n){const e=(null==n?void 0:n.message)||(null==n?void 0:n.toString())||"Unknown error";t.error(`Delete account error: ${e}`,!0),alert(`Failed to delete account: ${e}`)}},className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 text-sm font-semibold rounded-md border border-red-600 bg-red-600 text-white hover:bg-red-700 hover:border-red-700 transition-colors",children:[o.jsx("i",{className:"fas fa-trash-alt"}),o.jsx("span",{children:"Delete Account"})]}),o.jsxs("button",{onClick:async()=>{if(confirm("Are you sure you want to logout?"))try{if(u===s.RUNNING||"Running"===u)try{await e.set("bidding",{...i,status:s.STOPPED,isRunning:!1}),chrome.runtime.sendMessage({action:"stopBot"}).catch(()=>{})}catch(a){}await e.remove("auth"),await e.remove("profile"),await e.set("logs",{logs:[],unreadCount:0}),t.success("Logged out successfully",!0),r(),window.location.reload()}catch(n){const e=(null==n?void 0:n.message)||(null==n?void 0:n.toString())||"Unknown error";t.error(`Logout error: ${e}`,!0),alert(`Logout failed: ${e}`)}},className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 text-sm font-semibold rounded-md border border-red-500 bg-red-500 text-white hover:bg-red-600 hover:border-red-600 transition-colors",children:[o.jsx("i",{className:"fas fa-right-from-bracket"}),o.jsx("span",{children:"Logout"})]})]})})]})]})})}function dr({onClose:r,onLoginSuccess:s}){const[a,l]=n.useState(!1),[i,d]=n.useState(""),[c,u]=n.useState(""),[b,h]=n.useState(""),[x,f]=n.useState(""),[g,p]=n.useState(""),[v,y]=n.useState(!1),[w,j]=n.useState(!1),N=()=>{try{if("undefined"==typeof document||!document.cookie)return{userId:null,authToken:null};const e=document.cookie.match(/GETAFREE_USER_ID=(\d+)/),t=e?e[1]:null,r=document.cookie.match(/GETAFREE_AUTH_HASH_V2=(\S+?)(?:;|$)/),s=r?r[1].replace(/;/g,""):null;return t&&s?{userId:t,authToken:`${t};${s}`}:{userId:null,authToken:null}}catch(e){return t.error(`Error getting Freelancer auth: ${e.message}`),{userId:null,authToken:null}}},k=async n=>{var o;if(null==n||n.preventDefault(),f(""),p(""),i&&c){if(a){if(c.length<6)return void f("Password must be at least 6 characters");if(c!==b)return void f("Passwords do not match")}y(!0);try{const{userId:n,authToken:o}=N();let d;if(d=a?await m.signupWithEmail(i,c,n,o):await m.loginWithEmail(i,c,n,o),d.success&&d.user&&d.session)await e.set("auth",{user:d.user,session:d.session,profile:d.profile||null,isAuthenticated:!0}),d.profile&&await e.set("profile",{profile:d.profile,cacheTime:Date.now()}),p(a?"Account created and logged in successfully!":"Login successful!"),t.success(a?"Account created and logged in":"Logged in successfully"),setTimeout(()=>{s&&s(),r()},1e3);else{if(!a||!d.user||d.session)throw new Error(d.error||(a?"Signup failed":"Login failed"));p("Account created! Please check your email to confirm your account."),setTimeout(()=>{l(!1)},2e3)}}catch(d){const e=(null==d?void 0:d.message)||(null==(o=null==d?void 0:d.payload)?void 0:o.message)||("string"==typeof d?d:a?"Signup failed. Please try again.":"Login failed. Please check your credentials.");f(e),t.error(`${a?"Signup":"Login"} error: ${e}`,!0)}finally{y(!1)}}else f("Please enter email and password")},C=e=>{"Enter"===e.key&&k(e)};return o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black bg-opacity-50",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:o.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg shadow-xl w-[450px] max-h-[80vh] flex flex-col overflow-hidden",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-dark-border cursor-move bg-dark-bg",children:[o.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[o.jsx("i",{className:"fas fa-user text-blue-400"}),a?"Sign Up":"Login"]}),o.jsx("button",{onClick:r,className:"text-white hover:text-gray-300 transition-colors",children:o.jsx("i",{className:"fas fa-times text-xl"})})]}),o.jsx("div",{className:"p-5 overflow-y-auto bg-dark-card",children:o.jsxs("form",{className:"space-y-4",onSubmit:k,children:[x&&o.jsx("div",{className:"bg-red-500 text-white p-3 rounded-md text-sm text-center break-words overflow-wrap-anywhere",children:x}),g&&o.jsx("div",{className:"bg-green-500 text-white p-3 rounded-md text-sm text-center break-words overflow-wrap-anywhere",children:g}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"email",className:"block text-sm font-semibold mb-1 text-white",children:"Email"}),o.jsx("input",{type:"email",id:"email",value:i,onChange:e=>d(e.target.value),onKeyPress:C,placeholder:"your@email.com",className:"w-full px-3 py-2 border border-dark-border rounded-md text-sm bg-dark-bg text-white focus:outline-none focus:border-blue-500 focus:bg-dark-card",disabled:v,required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"password",className:"block text-sm font-semibold mb-1 text-white",children:"Password"}),o.jsx("input",{type:"password",id:"password",value:c,onChange:e=>u(e.target.value),onKeyPress:C,placeholder:a?"Your password (min 6 characters)":"Your password",className:"w-full px-3 py-2 border border-dark-border rounded-md text-sm bg-dark-bg text-white focus:outline-none focus:border-blue-500 focus:bg-dark-card",disabled:v,required:!0})]}),a&&o.jsxs("div",{children:[o.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-semibold mb-1 text-white",children:"Confirm Password"}),o.jsx("input",{type:"password",id:"confirmPassword",value:b,onChange:e=>h(e.target.value),onKeyPress:C,placeholder:"Confirm your password",className:"w-full px-3 py-2 border border-dark-border rounded-md text-sm bg-dark-bg text-white focus:outline-none focus:border-blue-500 focus:bg-dark-card",disabled:v,required:!0})]}),o.jsx("button",{type:"submit",disabled:v||w,className:"w-full py-2.5 bg-blue-500 text-white rounded-md text-sm font-bold hover:bg-blue-600 disabled:opacity-60 disabled:cursor-not-allowed transition-colors",children:v?a?"Signing up...":"Logging in...":a?"Create Account":"Login"}),o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-0 flex items-center",children:o.jsx("div",{className:"w-full border-t border-dark-border"})}),o.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:o.jsx("span",{className:"bg-dark-card px-2 text-gray-400",children:"Or"})})]}),o.jsxs("button",{type:"button",onClick:async n=>{null==n||n.preventDefault(),null==n||n.stopPropagation(),f(""),p(""),j(!0);try{const{userId:n,authToken:o}=N();chrome.runtime.sendMessage({action:"googleSignIn",freelancerUserId:n,freelancerAuthToken:o},async i=>{var d;if(chrome.runtime.lastError)return f(chrome.runtime.lastError.message||"Google sign-in failed"),void j(!1);if(i.error)return f(i.error),t.error(`Google sign-in error: ${i.error}`,!0),void j(!1);if(i.sessionToken)try{let d;if(d=a?await m.signupWithGoogle(i.sessionToken,i.refreshToken||null,i.expiresAt||null,n,o):await m.loginWithGoogle(i.sessionToken,i.refreshToken||null,i.expiresAt||null,n,o),d.success&&d.user&&d.session)await e.set("auth",{user:d.user,session:d.session,profile:d.profile||null,isAuthenticated:!0}),d.profile&&await e.set("profile",{profile:d.profile,cacheTime:Date.now()}),p(a?"Account created and logged in successfully!":"Login successful!"),t.success(a?"Account created and logged in with Google successfully":"Logged in with Google successfully"),setTimeout(()=>{s&&s(),r()},1e3);else{if(!a||!d.user||d.session)throw new Error(d.error||(a?"Google sign-up failed":"Google sign-in failed"));p("Account created! Please check your email to confirm your account."),setTimeout(()=>{l(!1)},2e3),j(!1)}}catch(c){const e=(null==c?void 0:c.message)||(null==(d=null==c?void 0:c.payload)?void 0:d.message)||("string"==typeof c?c:a?"Google sign-up failed":"Google sign-in failed");f(e),t.error(`Google ${a?"sign-up":"sign-in"} error: ${e}`,!0)}finally{j(!1)}else f("No session token received"),j(!1)})}catch(o){const e=o.message||"Google sign-in failed";f(e),t.error(`Google sign-in error: ${e}`,!0),j(!1)}},disabled:v||w,className:"w-full py-2.5 bg-white text-gray-700 rounded-md text-sm font-bold hover:bg-gray-100 disabled:opacity-60 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2 border border-gray-300",children:[o.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[o.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),o.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),o.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),o.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),w?a?"Signing up...":"Signing in...":a?"Sign up with Google":"Sign in with Google"]}),o.jsx("button",{type:"button",onClick:()=>{l(!a),f(""),p(""),u(""),h("")},disabled:v||w,className:"w-full py-2.5 bg-gray-600 text-white rounded-md text-sm font-bold hover:bg-gray-700 disabled:opacity-60 disabled:cursor-not-allowed transition-colors",children:a?"Back to Login":"Sign Up"}),o.jsx("p",{className:"text-center text-xs text-gray-400 mt-4",children:a?"Already have an account? Click Back to Login":"Don't have an account? Click Sign Up"})]})})]})})}function cr({onClose:e}){const[t]=a("chat",{threads:[]}),r=(null==t?void 0:t.threads)||[],[s,l]=n.useState(null),[i,d]=n.useState(null);n.useEffect(()=>{},[r.length]);const c=e=>{if(!e)return"N/A";try{return(e>1e10?new Date(e):new Date(1e3*e)).toLocaleString()}catch(t){return"Invalid date"}};return o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black bg-opacity-50",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:o.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg shadow-xl w-[600px] max-h-[80vh] flex flex-col overflow-hidden",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-2.5 border-b border-dark-border cursor-move bg-dark-bg",children:[o.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[o.jsx("i",{className:"fas fa-comments text-blue-400"}),"Chat Threads (",r.length,")"]}),o.jsx("button",{onClick:e,className:"text-white hover:text-gray-300 transition-colors",title:"Close",children:o.jsx("i",{className:"fas fa-times text-xl"})})]}),o.jsxs("div",{className:"p-4 overflow-y-auto flex-1 bg-dark-card [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]",children:[null,0===r.length?o.jsxs("div",{className:"text-center py-8 text-white",children:[o.jsx("i",{className:"fas fa-comments text-4xl mb-4 block text-gray-400"}),o.jsx("p",{className:"text-white",children:"No chat threads yet."}),o.jsx("p",{className:"text-sm mt-2 text-gray-400",children:"Start chatting on projects to see threads here."})]}):o.jsx("div",{className:"space-y-3",children:r.map(e=>{var t;const r=i===e.threadId,s=(e=>e.chatHistory&&0!==e.chatHistory.length?e.chatHistory[e.chatHistory.length-1].message||"No message text":"No messages yet")(e),a=(e=>e.chatHistory&&0!==e.chatHistory.length&&e.chatHistory[e.chatHistory.length-1].time_created||null)(e),n=(null==(t=e.chatHistory)?void 0:t.length)||0;return o.jsxs("div",{className:"bg-dark-bg border border-dark-border rounded-lg mb-3 hover:border-blue-500 transition-colors",children:[o.jsx("div",{onClick:()=>{return t=e.threadId,void d(i===t?null:t);var t},className:"p-3 cursor-pointer",children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx("h3",{className:"text-white font-semibold truncate",children:e.projectTitle||`Thread #${e.threadId}`}),n>0&&o.jsxs("span",{className:"px-2 py-0.5 bg-blue-500 bg-opacity-20 text-blue-400 text-xs rounded",children:[n," ",1===n?"message":"messages"]})]}),o.jsx("p",{className:"text-gray-400 text-sm truncate mb-1",children:s}),o.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.projectId&&o.jsxs("span",{children:[o.jsx("i",{className:"fas fa-project-diagram mr-1"}),"Project: ",e.projectId]}),e.clientId&&o.jsxs("span",{children:[o.jsx("i",{className:"fas fa-user mr-1"}),"Client: ",e.clientId]}),a&&o.jsxs("span",{children:[o.jsx("i",{className:"fas fa-clock mr-1"}),c(a)]})]})]}),o.jsx("div",{className:"ml-4 flex items-center",children:o.jsx("i",{className:`fas fa-chevron-${r?"up":"down"} text-gray-400 transition-transform`})})]})}),r&&o.jsxs("div",{className:"border-t border-dark-border p-3 bg-dark-card",children:[e.projectDescription&&o.jsxs("div",{className:"mb-4",children:[o.jsxs("h4",{className:"text-sm font-semibold text-white mb-2",children:[o.jsx("i",{className:"fas fa-info-circle text-blue-400 mr-2"}),"Project Description"]}),o.jsx("p",{className:"text-sm text-gray-300 bg-dark-card p-3 rounded border border-dark-border max-h-32 overflow-y-auto",children:e.projectDescription})]}),o.jsxs("div",{children:[o.jsxs("h4",{className:"text-sm font-semibold text-white mb-2",children:[o.jsx("i",{className:"fas fa-comments text-blue-400 mr-2"}),"Chat History (",n,")"]}),0===n?o.jsx("p",{className:"text-sm text-gray-400 italic",children:"No messages in this thread yet."}):o.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto bg-dark-bg p-3 rounded border border-dark-border [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]",children:e.chatHistory.map((e,t)=>o.jsxs("div",{className:"text-sm p-2 rounded bg-dark-card border border-dark-border",children:[o.jsxs("div",{className:"flex items-center justify-between mb-1",children:[o.jsxs("span",{className:"text-blue-400 font-medium",children:["User ",e.from_user]}),e.time_created&&o.jsx("span",{className:"text-xs text-gray-400",children:c(e.time_created)})]}),o.jsx("p",{className:"text-white",children:e.message||"No message text"})]},e.id||t))})]}),o.jsx("div",{className:"mt-4 pt-4 border-t border-dark-border",children:o.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-500",children:"Thread ID:"}),o.jsx("span",{className:"text-white ml-2",children:e.threadId})]}),e.supabaseTableId&&o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-500",children:"DB ID:"}),o.jsxs("span",{className:"text-white ml-2 font-mono text-xs",children:[e.supabaseTableId.substring(0,8),"..."]})]})]})})]})]},e.threadId)})})]})]})})}function ur({activePanel:e,onClose:t}){return o.jsxs(o.Fragment,{children:["profile"===e&&o.jsx(b,{onClose:t}),"project"===e&&o.jsx(x,{onClose:t}),"logs"===e&&o.jsx(f,{onClose:t}),"telegram"===e&&o.jsx(g,{onClose:t}),"customai"===e&&o.jsx(v,{onClose:t}),"settings"===e&&o.jsx(y,{onClose:t}),"filters"===e&&o.jsx(j,{onClose:t}),"template"===e&&o.jsx(lr,{onClose:t}),"account"===e&&o.jsx(ir,{onClose:t}),"login"===e&&o.jsx(dr,{onClose:t}),"auth"===e&&o.jsx(dr,{onClose:t}),"chat"===e&&o.jsx(cr,{onClose:t})]})}let mr=null,br=null;const hr="bot-react-modal-container";const xr=new class{constructor(){this.isInitialized=!1}async init(){if(!this.isInitialized){if(!document.getElementById(hr)){const e=document.createElement("div");e.id=hr,document.body.appendChild(e)}this.isInitialized=!0}}async showPanel(e){this.isInitialized||await this.init(),this.hidePanel();document.getElementById(hr)?(br=e,mr=function(e,t,r){const s=document.getElementById(e);if(s){const e=d(s);return e.render(o.jsx(l.StrictMode,{children:o.jsx(ur,{activePanel:t,onClose:r})})),e}return null}(hr,e,()=>{this.hidePanel()}),mr||t.error("Failed to mount panel - mountBotPanel returned null")):t.error("Modal container not found")}hidePanel(){mr&&(mr.unmount(),mr=null),br=null;const e=document.getElementById(hr);e&&(e.innerHTML="")}isPanelShown(){return null!==br}};window.modalManager=xr;const fr=new class{constructor(){this.lastUrl="undefined"!=typeof window?window.location.href:"",this.navigationInterval=null,this.isInitialized=!1}async init(){this.isInitialized||("undefined"!=typeof window?(this.watchNavigation(),this.isInitialized=!0,this.initializeProjectPage()):this.isInitialized=!0)}watchNavigation(){if("undefined"==typeof window)return;let e=window.location.href;this.navigationInterval=setInterval(()=>{if(window.location.href!==e){e=window.location.href,this.lastUrl=e;window.location.pathname.match(/\/projects\/(.+?)(?:\/details)?(?:\?|$)/)&&setTimeout(()=>{this.initializeProjectPage()},1e3)}},500),window.addEventListener("popstate",()=>{setTimeout(()=>{window.location.pathname.match(/\/projects\/(.+?)(?:\/details)?(?:\?|$)/)&&this.initializeProjectPage()},500)});const t=history.pushState,r=history.replaceState,s=this;history.pushState=function(...e){t.apply(history,e),setTimeout(()=>{window.location.pathname.match(/\/projects\/(.+?)(?:\/details)?(?:\?|$)/)&&window.location.href!==s.lastUrl&&(s.lastUrl=window.location.href,s.initializeProjectPage())},500)},history.replaceState=function(...e){r.apply(history,e),setTimeout(()=>{window.location.pathname.match(/\/projects\/(.+?)(?:\/details)?(?:\?|$)/)&&window.location.href!==s.lastUrl&&(s.lastUrl=window.location.href,s.initializeProjectPage())},500)}}async initializeProjectPage(){var r,s;if("undefined"==typeof window)return;const a=window.location.pathname.match(/\/projects\/(.+?)(?:\/details)?(?:\?|$)/);if(!a)return;const n=a[1].replace(/\/$/,"");await this.waitForPageLoad();try{t.log(`Looking up project ID using SEO URL: ${n}`);const a=await c.lookupProjectBySeoUrl(n);if(!a.success||!a.project||!a.project.id)return void t.warn("Could not find project ID via SEO URL API");const o=a.project,l=o.id,i=await e.get("auth"),d=null==(r=null==i?void 0:i.profile)?void 0:r.freelancer_auth_token;t.log(`Fetching project details for ID: ${l}`);const m=await c.fetchProjectDetails(l,d);if(m.success){const t=u.normalizeProjectData(m.data);await e.set("project",{currentProject:t,currentEmployerId:(null==t?void 0:t.owner_id)||null})}const b=(await e.get("settings")||{}).openProjectModal;if(b&&window.modalManager){const r=await e.get("auth");if(!((null==r?void 0:r.isAuthenticated)||(null==r?void 0:r.user)&&(null==r?void 0:r.session)))return void t.log("User is not authenticated. Skipping project modal auto-open.")}if(o.owner_id){t.log(`Fetching employer details for ID: ${o.owner_id}`);const r=await c.fetchEmployerDetails(o.owner_id);if(r.success){const t=await e.get("project")||{};await e.set("project",{...t,employerDetails:r.data,currentEmployerId:(null==(s=r.data)?void 0:s.id)||o.owner_id});const a=u.getUserId();if(a&&d){const t=await c.checkSelfBid(l,a,d);if(t.success){const r=await e.get("project")||{};await e.set("project",{...r,hasBid:t.hasBid,bidInfo:t})}}b&&"undefined"!=typeof window&&window.modalManager&&window.modalManager.showPanel("project")}}else b&&"undefined"!=typeof window&&window.modalManager&&window.modalManager.showPanel("project")}catch(o){t.error(`Error initializing project page: ${o.message}`)}}async waitForPageLoad(){return"undefined"==typeof window||"undefined"==typeof document?Promise.resolve():new Promise(e=>{"complete"===document.readyState?e():window.addEventListener("load",e,{once:!0})})}cleanup(){this.navigationInterval&&(clearInterval(this.navigationInterval),this.navigationInterval=null)}};if(!document.querySelector('link[href*="font-awesome"]')){const e=document.createElement("link");e.rel="stylesheet",e.href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css",e.integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==",e.crossOrigin="anonymous",e.referrerPolicy="no-referrer",document.head.appendChild(e)}!async function(){function r(e,t,r){try{const t={success:"âœ…",error:"âŒ",warn:"âš ï¸",info:"â„¹ï¸"}[e.type]||"â„¹ï¸",s=e.sender||"unknown",a=`${`[FreelancerBot-${s}] ${t}`} ${e.message}`,n={success:"color: #10b981; font-weight: bold;",error:"color: #ef4444; font-weight: bold;",warn:"color: #f59e0b; font-weight: bold;",info:"color: #3b82f6; font-weight: normal;"},o=n[e.type]||n.info;return console.log(`%c${a}`,o),r({success:!0}),!1}catch(s){return r({success:!1,error:s.message}),!1}}function s(e,r,s){try{const e=function(){try{if("undefined"==typeof document||!document.cookie)return null;const e=document.cookie.match(/GETAFREE_USER_ID=(\d+)/),t=e?e[1]:null,r=document.cookie.match(/GETAFREE_AUTH_HASH_V2=(\S+?)(?:;|$)/),s=r?r[1].replace(/;/g,""):null;return t&&s?`${t};${s}`:null}catch(e){return t.error(`Error getting auth token: ${e.message}`),null}}();return e?s({success:!0,authToken:e}):(t.warn("Auth token not found"),s({success:!1,message:"Auth token not found. Please login to Freelancer.com first."})),!1}catch(a){return t.error(`Error getting auth token: ${a.message}`),s({success:!1,message:a.message}),!1}}function a(e,r,s){const a=e.tabName||"profile";return window.location.href.includes("freelancer.com")?(xr.showPanel(a).then(()=>{s({success:!0,message:`Panel ${a} shown successfully`})}).catch(e=>{t.error(`Error showing panel: ${e.message}`),s({success:!1,message:`Error showing panel: ${e.message}`})}),!0):(s({success:!1,message:"Please navigate to Freelancer.com first."}),!1)}function n(e,t,r){try{return xr.hidePanel(),r({success:!0}),!1}catch(s){return r({success:!1,message:s.message}),!1}}function o(r,s,a){try{const{sliceName:s,stateKey:n,value:o}=r;switch(s){case"settings":case"filters":case"telegram":case"customai":return(async()=>{try{const t=await e.get(s)||{};await e.set(s,{...t,[n]:o}),a({success:!0})}catch(r){t.error(`Error setting slice value: ${r.message}`),a({success:!1,message:r.message})}})(),!0;default:return a({success:!1,message:`Slice "${s}" not supported for setSliceValue`}),!1}}catch(n){return t.error(`Error setting slice value: ${n.message}`),a({success:!1,message:n.message}),!1}}function l(r,s,a){try{const{sliceName:s,newState:n}=r;switch(s){case"settings":case"filters":case"telegram":case"customai":return(async()=>{try{await e.set(s,n),a({success:!0})}catch(r){t.error(`Error setting slice state: ${r.message}`),a({success:!1,message:r.message})}})(),!0;default:return a({success:!1,message:`Slice "${s}" not supported for setSliceState`}),!1}}catch(n){return t.error(`Error setting slice state: ${n.message}`),a({success:!1,message:n.message}),!1}}function i(e,t,r){return r({success:!0,message:"Content script is available"}),!1}chrome.runtime.onMessage.addListener((e,t,d)=>{const c={ping:i,log:r,getAuthToken:s,showPanel:a,hidePanel:n,setSliceValue:o,setSliceState:l}[e.action];if(c){const r=c(e,t,d);return void 0===r||r}return!0}),await fr.init(),await xr.init();try{await u.fetchCurrencies()}catch(c){t.warn(`Failed to fetch currencies: ${c.message}`)}let d=null;e.get("bidding").then(e=>{d=e||{}}).catch(()=>{}),e.subscribe(async(e,r,s)=>{if("bidding"===e)try{const e=r||{},s={};(null==e?void 0:e.status)!==(null==d?void 0:d.status)&&(s.scriptStatus=null==e?void 0:e.status),(null==e?void 0:e.sessionBidsCount)!==(null==d?void 0:d.sessionBidsCount)&&(s.sessionBidsCount=null==e?void 0:e.sessionBidsCount),Object.keys(s).length>0&&chrome.storage.local.set(s,()=>{chrome.runtime.lastError&&t.error(`Error updating storage: ${chrome.runtime.lastError.message}`)}),d=e}catch(c){t.error(`Error in storage subscription: ${c.message}`)}})}();
