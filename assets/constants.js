const e=new class{constructor(){this.isChromeExtension="undefined"!=typeof chrome&&chrome.storage}async get(e){if(this.isChromeExtension)return new Promise(t=>{chrome.storage.local.get([e],s=>{if(chrome.runtime.lastError)t(null);else{const r=s[e];if("string"==typeof r)try{t(JSON.parse(r))}catch{t(r)}else t(r)}})});try{const t=localStorage.getItem(e);if(null===t)return null;try{return JSON.parse(t)}catch{return t}}catch{return null}}async set(e,t){if(this.isChromeExtension)return new Promise((s,r)=>{const o="string"==typeof t?t:JSON.stringify(t);chrome.storage.local.set({[e]:o},()=>{chrome.runtime.lastError?r(chrome.runtime.lastError):s()})});try{const s="string"==typeof t?t:JSON.stringify(t);return localStorage.setItem(e,s),Promise.resolve()}catch(s){return Promise.reject(s)}}async remove(e){if(this.isChromeExtension)return new Promise((t,s)=>{chrome.storage.local.remove([e],()=>{chrome.runtime.lastError?s(chrome.runtime.lastError):t()})});try{return localStorage.removeItem(e),Promise.resolve()}catch(t){return Promise.reject(t)}}async getMultiple(e){if(this.isChromeExtension)return new Promise(t=>{chrome.storage.local.get(e,s=>{if(chrome.runtime.lastError)t({});else{const r={};for(const t of e){const e=s[t];if(void 0!==e)if("string"==typeof e)try{r[t]=JSON.parse(e)}catch{r[t]=e}else r[t]=e}t(r)}})});{const t={};for(const s of e)try{const e=localStorage.getItem(s);if(null!==e)try{t[s]=JSON.parse(e)}catch{t[s]=e}}catch{}return Promise.resolve(t)}}async setMultiple(e){if(this.isChromeExtension)return new Promise((t,s)=>{const r={};for(const[o,n]of Object.entries(e))r[o]="string"==typeof n?n:JSON.stringify(n);chrome.storage.local.set(r,()=>{chrome.runtime.lastError?s(chrome.runtime.lastError):t()})});try{for(const[t,s]of Object.entries(e)){const e="string"==typeof s?s:JSON.stringify(s);localStorage.setItem(t,e)}return Promise.resolve()}catch(t){return Promise.reject(t)}}async clear(){if(this.isChromeExtension)return new Promise((e,t)=>{chrome.storage.local.clear(()=>{chrome.runtime.lastError?t(chrome.runtime.lastError):e()})});try{return localStorage.clear(),Promise.resolve()}catch(e){return Promise.reject(e)}}subscribe(e){if(this.isChromeExtension){const t=(t,s)=>{if("local"===s)for(const[r,o]of Object.entries(t)){const t=o.newValue,s=o.oldValue;let n=t,a=s;if("string"==typeof t)try{n=JSON.parse(t)}catch{}if("string"==typeof s)try{a=JSON.parse(s)}catch{}e(r,n,a)}};return chrome.storage.onChanged.addListener(t),()=>chrome.storage.onChanged.removeListener(t)}{const t=t=>{if(t.key){let s=t.newValue,r=t.oldValue;if(null!==s)try{s=JSON.parse(s)}catch{}if(null!==r)try{r=JSON.parse(r)}catch{}e(t.key,s,r)}};return window.addEventListener("storage",t),()=>window.removeEventListener("storage",t)}}};async function t(e,t,s){try{if(!e||!t||!s)return{success:!1,message:"Bot token, chat ID, and message are required"};const r=`https://api.telegram.org/bot${e}/sendMessage`,o=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:t,text:s,parse_mode:"HTML"})}),n=await o.json();return n.ok?{success:!0,message:"Message sent successfully",data:n.result}:{success:!1,message:n.description||"Failed to send message",error:n.description}}catch(r){return{success:!1,message:r.message||"Failed to send Telegram message",error:r.message}}}const s={sendMessage:t,testConnection:async function(e,s){try{if(!e||!s)return{success:!1,message:"Bot token and chat ID are required"};const r="âœ… Telegram connection test successful! Your bot is configured correctly.";return await t(e,s,r)}catch(r){return{success:!1,message:r.message||"Connection test failed",error:r.message}}},getBotInfo:async function(e){try{if(!e)return{success:!1,message:"Bot token is required"};const t=`https://api.telegram.org/bot${e}/getMe`,s=await fetch(t),r=await s.json();return r.ok?{success:!0,message:"Bot info retrieved successfully",bot:r.result}:{success:!1,message:r.description||"Failed to get bot info",error:r.description}}catch(t){return{success:!1,message:t.message||"Failed to get bot info",error:t.message}}}};async function r(t,r="info",o=!1,n=!1){try{const a="undefined"!=typeof chrome&&chrome.tabs&&"undefined"==typeof window?"background":"undefined"!=typeof window&&window.location&&"chrome-extension:"===window.location.protocol?"popup":"undefined"==typeof window||!window.location||"http:"!==window.location.protocol&&"https:"!==window.location.protocol?"unknown":"content";if("background"===a)return void(await async function(t,r,o,n,a){const c=[];"undefined"!=typeof chrome&&chrome.tabs&&chrome.tabs.query&&c.push((async()=>{try{const e=await new Promise(e=>{chrome.tabs.query({url:"https://www.freelancer.com/*"},t=>{e(t||[])})});e&&e.length>0&&e.forEach(e=>{chrome.tabs.sendMessage(e.id,{action:"log",message:t,type:r,sender:o,timestamp:(new Date).toISOString()}).catch(()=>{})})}catch(e){console.warn("[Logger] Could not send log to content scripts:",e.message)}})()),n&&c.push((async()=>{try{const s=await e.get("logs")||{logs:[],unreadCount:0};s.logs=s.logs||[],s.unreadCount=s.unreadCount||0,s.logs.push({message:t,type:r,sender:o||"unknown",timestamp:Date.now()}),s.unreadCount=(s.unreadCount||0)+1,s.logs.length>100&&(s.logs=s.logs.slice(-100)),await e.set("logs",s)}catch(s){console.error("[Logger] Error adding log to storage:",s)}})()),a&&c.push((async()=>{try{const o=await e.get("telegram")||{};if(o.enabled&&o.botToken&&o.chatId){const e=`[${r.toUpperCase()}] ${t}`,n=await s.sendMessage(o.botToken,o.chatId,e);n.success||console.error("[Logger] Failed to send Telegram message:",n.message)}}catch(o){console.error("[Logger] Error sending Telegram log:",o)}})());try{await Promise.all(c)}catch(i){console.error("[Logger] Error handling log:",i)}}(t,r,a,o,n));chrome.runtime.sendMessage({action:"log",message:t,type:r,sender:a,showUI:o,sendTelegram:n,timestamp:(new Date).toISOString()}).catch(()=>{})}catch(a){}}const o={log:async(e,t=!1,s=!1)=>await r(e,"info",t,s),success:async(e,t=!1,s=!1)=>await r(e,"success",t,s),error:async(e,t=!1,s=!1)=>await r(e,"error",t,s),warn:async(e,t=!1,s=!1)=>await r(e,"warn",t,s)};"undefined"!=typeof window&&(window.logger=o);var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function a(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function c(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var s=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};s.prototype=t.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(e).forEach(function(t){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(s,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})}),s}const i={BASE_URL:"https://www.freelancer.com",PROJECTS:"/api/projects/0.1/projects/active",PROJECT_SEARCH:"/api/projects/0.1/projects",BIDS:"/api/bids",PROJECT_DETAILS:"/api/projects/0.1/projects/",PLACE_BID:"/api/projects/0.1/bids/",UPDATE_BID:"/api/projects/0.1/bids/",USER_PROFILE:"/api/users/0.1/self",USER_DETAILS:"/api/users/0.1/users/",CAN_BID_ON_PROJECT:"/ajax-api/projects/freelancerCanBidOnProject.php",CHECK_SELF_BID:"/api/projects/0.1/bids",CREATE_MESSAGE_THREAD:"/api/messages/0.1/threads/",GET_MESSAGES:"/api/messages/0.1/messages/",SEND_MESSAGE:"/api/messages/0.1/messages/",CURRENCIES:"/api/projects/0.1/currencies/"},l={URL:"https://zscjfgjmutddidwluami.supabase.co",ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpzY2pmZ2ptdXRkZGlkd2x1YW1pIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUzMDYzNDEsImV4cCI6MjA4MDg4MjM0MX0.ekK1nDp0qjFdvbdEPw3YjN7S18OwkhmVzThTqptb308"},u={STOPPED:"Stopped",RUNNING:"Running",PAUSED:"Paused"},g=864e5;"undefined"!=typeof window&&(window.API_ENDPOINTS=i,window.SCRIPT_STATUS=u,window.SUPABASE_CONFIG=l,window.CURRENCIES_CACHE_DURATION=g);export{i as A,g as C,u as S,l as a,a as b,n as c,c as g,o as l,e as s,s as t};
